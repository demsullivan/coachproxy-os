[{"id":"5a05b8f3.894b88","type":"tab","label":"Main"},{"id":"2fdd8124.05e35e","type":"tab","label":"Notify / System"},{"id":"477cac19.6a9e64","type":"tab","label":"Logic","disabled":false,"info":""},{"id":"f6c367c2.63b9b8","type":"tab","label":"Configuration","disabled":false,"info":""},{"id":"5900d0c.97552b","type":"ui_tab","z":"5a05b8f3.894b88","name":"Status","icon":"visibility","order":6},{"id":"7105c79c.41caf8","type":"ui_tab","z":"5a05b8f3.894b88","name":"Climate","icon":"brightness_4","order":4},{"id":"ff74463f.aaa268","type":"ui_tab","z":"5a05b8f3.894b88","name":"Shades","icon":"reorder","order":3},{"id":"c1170463.5c7f8","type":"mqtt-broker","z":"","broker":"localhost","port":"1883","clientid":"","usetls":false,"verifyservercert":true,"compatmode":true,"keepalive":"15","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"true","birthPayload":"","willTopic":"","willQos":"0","willRetain":"true","willPayload":""},{"id":"221dd600.02338a","type":"ui_tab","z":"5a05b8f3.894b88","name":"Exterior","icon":"directions_bus","order":2},{"id":"ca7e3f9c.a33c","type":"ui_tab","z":"5a05b8f3.894b88","name":"Interior","icon":"home","order":1},{"id":"d25468b.e8be398","type":"ui_group","z":"5a05b8f3.894b88","name":"Driver Side","tab":"ca7e3f9c.a33c","order":2,"disp":true,"width":"6"},{"id":"b515d680.664548","type":"ui_group","z":"5a05b8f3.894b88","name":"Mid Bath","tab":"ca7e3f9c.a33c","order":8,"disp":true,"width":"6"},{"id":"4da57d95.96a5cc","type":"ui_tab","z":"2fdd8124.05e35e","name":"Notifications","icon":"notifications_active","order":7},{"id":"b2130e68.3a338","type":"sqlitedb","z":"2fdd8124.05e35e","db":"/coachproxy/node-red/coachproxy.sqlite"},{"id":"2e0a52f8.6acbee","type":"ui_group","z":"5a05b8f3.894b88","name":"Main","tab":"ca7e3f9c.a33c","order":1,"disp":true,"width":"6","collapse":false},{"id":"52a2a990.dc9ba","type":"ui_group","z":"5a05b8f3.894b88","name":"Passenger Side","tab":"ca7e3f9c.a33c","order":3,"disp":true,"width":"6"},{"id":"cae5b35a.e3024","type":"ui_group","z":"5a05b8f3.894b88","name":"Water","tab":"221dd600.02338a","order":3,"disp":true,"width":"6"},{"id":"517030c5.11f8b8","type":"ui_group","z":"5a05b8f3.894b88","name":"Bedroom","tab":"ca7e3f9c.a33c","order":9,"disp":true,"width":"6"},{"id":"f92ef285.8be6b","type":"ui_group","z":"5a05b8f3.894b88","name":"Rear Bath","tab":"ca7e3f9c.a33c","order":10,"disp":true,"width":"6"},{"id":"4e2af34d.8f765c","type":"ui_group","z":"5a05b8f3.894b88","name":"Exterior Lights","tab":"221dd600.02338a","order":1,"disp":true,"width":"6","collapse":false},{"id":"bb6f833c.5c7e8","type":"ui_group","z":"5a05b8f3.894b88","name":"Vent Fans","tab":"7105c79c.41caf8","order":1,"disp":true,"width":"6"},{"id":"433f3067.41111","type":"ui_group","z":"5a05b8f3.894b88","name":"Heated Floors","tab":"7105c79c.41caf8","order":2,"disp":true,"width":"6"},{"id":"7524ce0d.45bda","type":"ui_group","z":"","name":"General Shades","tab":"ff74463f.aaa268","order":1,"disp":true,"width":"6","collapse":false},{"id":"69274a36.07e384","type":"ui_group","z":"","name":"Main Shades","tab":"ff74463f.aaa268","order":3,"disp":true,"width":"6","collapse":false},{"id":"f6ae28b7.041968","type":"ui_group","z":"","name":"Locks","tab":"221dd600.02338a","order":2,"disp":true,"width":"6"},{"id":"87ed7eaa.ab8fe","type":"ui_group","name":"Readings","tab":"5900d0c.97552b","order":1,"disp":true,"width":6},{"id":"a4a573ee.d6bdf","type":"ui_group","name":"Generator","tab":"5900d0c.97552b","order":3,"disp":true,"width":6},{"id":"d944623c.5b46b8","type":"ui_group","z":"","name":"General","tab":"ca7e3f9c.a33c","order":12,"disp":true,"width":"6","collapse":false},{"id":"f961f048.b0646","type":"ui_group","z":"","name":"System Information","tab":"10cd091e.2c38a7","order":1,"disp":true,"width":"6","collapse":false},{"id":"cd05e210.dac658","type":"ui_group","z":"","name":"Network Information","tab":"10cd091e.2c38a7","order":2,"disp":true,"width":"6"},{"id":"b29ba418.731d88","type":"ui_base","theme":{"name":"theme-custom","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#169dd3","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"default":"#4B7930","baseColor":"#3d89be","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#0094ce","value":"#0094ce","edited":false},"page-titlebar-backgroundColor":{"value":"#3d89be","edited":true},"page-backgroundColor":{"value":"#e8e8e8","edited":true},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#3d89be","edited":true},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#3d89be","edited":true},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"CoachProxyOS","hideToolbar":"false","allowSwipe":"false","dateFormat":"YYYY/MM/DD","sizes":{"sx":46,"sy":48,"gx":14,"gy":14,"cx":6,"cy":6,"px":4,"py":6}}},{"id":"5d7e55cd.f34c2c","type":"ui_group","z":"","name":"Awnings","tab":"221dd600.02338a","order":5,"disp":true,"width":"6","collapse":false},{"id":"2ea4e9b3.d5cca6","type":"ui_group","z":"","name":"Temperatures","tab":"221dd600.02338a","order":4,"disp":true,"width":"6"},{"id":"71f15ecb.66179","type":"ui_group","z":"","name":"Closet","tab":"ca7e3f9c.a33c","order":11,"disp":true,"width":"6","collapse":false},{"id":"39ecc94c.7e22c6","type":"ui_group","z":"","name":"Coach Selection","tab":"2b742e36.100002","order":1,"disp":true,"width":"6","collapse":false},{"id":"dd373808.7ec1d8","type":"ui_group","z":"","name":"Coach Options","tab":"2b742e36.100002","order":2,"disp":true,"width":"6","collapse":false},{"id":"e1a5049d.4cee88","type":"ui_group","z":"","name":"Save and Install","tab":"2b742e36.100002","order":4,"disp":true,"width":"6","collapse":false},{"id":"b9bfcd9c.3c935","type":"sqlitedb","z":"","db":"/coachproxy/node-red/coachproxy.sqlite"},{"id":"2b742e36.100002","type":"ui_tab","z":"","name":"Configuration","icon":"dashboard","order":11},{"id":"19e29091.0561df","type":"ui_group","z":"","name":"Bedroom Shades","tab":"ff74463f.aaa268","order":5,"disp":true,"width":"6","collapse":false},{"id":"ca0e7a6e.ef51c8","type":"ui_group","z":"","name":"Cockpit Shades","tab":"ff74463f.aaa268","order":2,"disp":true,"width":"6","collapse":false},{"id":"f77258cc.3f76a8","type":"ui_group","z":"","name":"TV Lift","tab":"ca7e3f9c.a33c","order":7,"disp":true,"width":"6","collapse":false},{"id":"10cd091e.2c38a7","type":"ui_tab","z":"","name":"System","icon":"settings","order":10},{"id":"fb4c3e00.5737a","type":"ui_group","z":"","name":"Power","tab":"5900d0c.97552b","order":2,"disp":true,"width":"6","collapse":false},{"id":"a47948b7.53b7b8","type":"ui_group","z":"","name":"Presets","tab":"84db6cba.06bc7","order":1,"disp":true,"width":"6","collapse":false},{"id":"7fba8042.84c76","type":"ui_group","z":"","name":"Save Presets","tab":"84db6cba.06bc7","order":2,"disp":true,"width":"6","collapse":false},{"id":"84db6cba.06bc7","type":"ui_tab","z":"","name":"Presets","icon":"favorite","order":5},{"id":"23adf1d9.326cae","type":"ui_group","z":"","name":"New Remote Access","tab":"10cd091e.2c38a7","order":3,"disp":true,"width":"6","collapse":false},{"id":"bde278fe.c02fc8","type":"ui_group","z":"","name":"Galley","tab":"ca7e3f9c.a33c","order":5,"disp":true,"width":"6","collapse":false},{"id":"2044d0f5.90c6c","type":"ui_group","z":"","name":"Hall","tab":"ca7e3f9c.a33c","order":6,"disp":true,"width":"6","collapse":false},{"id":"10afdb4b.d8c455","type":"ui_group","z":"","name":"Thermostats","tab":"7105c79c.41caf8","order":3,"disp":true,"width":"6","collapse":false},{"id":"7dcb24f9.ce47cc","type":"ui_group","z":"","name":"Alexa Commands","tab":"10cd091e.2c38a7","order":5,"disp":true,"width":"6","collapse":false},{"id":"a027aa68.277858","type":"ui_group","z":"","name":"Restart Alexa Integration","tab":"10cd091e.2c38a7","order":4,"disp":true,"width":"6","collapse":false},{"id":"55e07bb2.3f18c4","type":"ui_group","z":"","name":"Living Room","tab":"ca7e3f9c.a33c","order":4,"disp":true,"width":"6","collapse":false},{"id":"f4d0f875.b5dda8","type":"ui_group","z":"","name":"User Interface Options","tab":"2b742e36.100002","order":3,"disp":true,"width":"6","collapse":false},{"id":"7f355d52.ee5a24","type":"ui_group","z":"","name":"Notification Rules","tab":"4da57d95.96a5cc","order":4,"disp":true,"width":"6","collapse":false},{"id":"d0c7f134.375fd","type":"ui_group","z":"","name":"Notification Settings","tab":"4da57d95.96a5cc","order":1,"disp":true,"width":"6","collapse":false},{"id":"9ed66528.add608","type":"ui_group","z":"","name":"Notification Email Address","tab":"4da57d95.96a5cc","order":2,"disp":true,"width":"6","collapse":false},{"id":"e4fd4ed4.a377f","type":"ui_group","z":"","name":"About","tab":"2b742e36.100002","order":5,"disp":true,"width":"6","collapse":false},{"id":"b043acd4.87089","type":"ui_group","z":"","name":"Notification SMTP Server","tab":"4da57d95.96a5cc","order":3,"disp":true,"width":"6","collapse":false},{"id":"8918319e.52f4","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_25/+pred/","label":"Ceiling","tooltip":"","group":"2e0a52f8.6acbee","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"25_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":140,"wires":[["2b9cec.6cfee314"]]},{"id":"e3a07cfd.ff85a","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_25/brightness/","label":"","tooltip":"","group":"2e0a52f8.6acbee","order":21,"width":"3","height":"1","passthru":false,"outs":"end","topic":"25_brightness","min":"1","max":"100","step":"","x":860,"y":180,"wires":[["2b9cec.6cfee314"]]},{"id":"b7651bea.41be5","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_2/+pred/","label":"Entry","tooltip":"","group":"2e0a52f8.6acbee","order":10,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"2_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":220,"wires":[["2b9cec.6cfee314"]]},{"id":"bde18df6.2960f","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_2/brightness/","label":"","group":"2e0a52f8.6acbee","order":11,"width":"3","height":"1","passthru":false,"topic":"2_brightness","min":"1","max":"100","step":"","x":850,"y":260,"wires":[["2b9cec.6cfee314"]]},{"id":"f766527c.b54708","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_3/+pred/","label":"Ceiling","group":"52a2a990.dc9ba","order":10,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"3_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":300,"wires":[["2b9cec.6cfee314"]]},{"id":"32fb20fc.33fb1","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_3/brightness/","label":"","group":"52a2a990.dc9ba","order":11,"width":"3","height":"1","passthru":false,"topic":"3_brightness","min":"1","max":"100","step":"","x":850,"y":340,"wires":[["2b9cec.6cfee314"]]},{"id":"77238d9f.d85fac","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_4/+pred/","label":"Ceiling","group":"d25468b.e8be398","order":10,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"4_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":380,"wires":[["2b9cec.6cfee314"]]},{"id":"b5f5aa62.b1b8c","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_4/brightness/","label":"","group":"d25468b.e8be398","order":11,"width":"3","height":"1","passthru":false,"topic":"4_brightness","min":"1","max":"100","step":"","x":850,"y":420,"wires":[["2b9cec.6cfee314"]]},{"id":"4f494263.b11554","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/dc_dimmer.pl ","addpay":true,"append":"","useSpawn":"","name":"","x":1210,"y":1500,"wires":[[],[],[]]},{"id":"e291aabb.d74588","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_8/+pred/","label":"Slide","group":"d25468b.e8be398","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"8_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":700,"wires":[["2b9cec.6cfee314"]]},{"id":"d573ae50.c4dc38","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_8/brightness/","label":"","group":"d25468b.e8be398","order":21,"width":"3","height":"1","passthru":false,"topic":"8_brightness","min":"1","max":"100","step":"","x":850,"y":740,"wires":[["2b9cec.6cfee314"]]},{"id":"93ad9c5a.823bf8","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_9/+pred/","label":"Courtesy","group":"d25468b.e8be398","order":30,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"9_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":780,"wires":[["2b9cec.6cfee314"]]},{"id":"a6532b96.f6876","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_9/brightness/","label":"","group":"d25468b.e8be398","order":31,"width":"3","height":"1","passthru":false,"topic":"9_brightness","min":"1","max":"100","step":"","x":850,"y":820,"wires":[["2b9cec.6cfee314"]]},{"id":"de5083f5.8f342","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_7/+pred/","label":"Sconce","group":"2e0a52f8.6acbee","order":40,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"7_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":620,"wires":[["2b9cec.6cfee314"]]},{"id":"255e8300.e6f6dc","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_7/brightness/","label":"","group":"2e0a52f8.6acbee","order":41,"width":"3","height":"1","passthru":false,"topic":"7_brightness","min":"1","max":"100","step":"","x":850,"y":660,"wires":[["2b9cec.6cfee314"]]},{"id":"443d87c4.3023d","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_6/+pred/","label":"Slide","group":"52a2a990.dc9ba","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"6_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":540,"wires":[["2b9cec.6cfee314"]]},{"id":"9ff3b254.0a9e","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_6/brightness/","label":"","group":"52a2a990.dc9ba","order":21,"width":"3","height":"1","passthru":false,"topic":"6_brightness","min":"1","max":"100","step":"","x":850,"y":580,"wires":[["2b9cec.6cfee314"]]},{"id":"3d478679.218eb2","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_19/+pred/","label":"Accent","group":"2e0a52f8.6acbee","order":50,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"19_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1360,"wires":[["2b9cec.6cfee314"]]},{"id":"84390b0f.966a78","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_14/+pred/","label":"Task","group":"d25468b.e8be398","order":40,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"14_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1160,"wires":[["2b9cec.6cfee314"]]},{"id":"1181d0df.43e3df","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_15/+pred/","label":"Ceiling","group":"b515d680.664548","order":4,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"15_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1200,"wires":[["2b9cec.6cfee314"]]},{"id":"e60ee355.41d3e","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_16/+pred/","label":"Vanity","group":"b515d680.664548","order":8,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"16_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1240,"wires":[["2b9cec.6cfee314"]]},{"id":"6462abc1.33600c","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_12/+pred/","label":"Ceiling","group":"517030c5.11f8b8","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"12_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":1020,"wires":[["2b9cec.6cfee314"]]},{"id":"27927976.cdaa96","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_12/brightness/","label":"","group":"517030c5.11f8b8","order":21,"width":"3","height":"1","passthru":false,"topic":"12_brightness","min":"1","max":"100","step":"","x":840,"y":1060,"wires":[["2b9cec.6cfee314"]]},{"id":"21309d67.8efe4a","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_11/+pred/","label":"Sconce","group":"517030c5.11f8b8","order":60,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"11_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":940,"wires":[["2b9cec.6cfee314"]]},{"id":"36b5f55f.b2f8d2","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_11/brightness/","label":"","group":"517030c5.11f8b8","order":61,"width":"3","height":"1","passthru":false,"topic":"11_brightness","min":"1","max":"100","step":"","x":840,"y":980,"wires":[["2b9cec.6cfee314"]]},{"id":"f1ceb03a.ba774","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_10/+pred/","label":"Courtesy","group":"517030c5.11f8b8","order":40,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"10_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":880,"y":860,"wires":[["2b9cec.6cfee314"]]},{"id":"285ed135.2d577e","type":"ui_slider","z":"5a05b8f3.894b88","name":"/brightness_10/brightness/","label":"","group":"517030c5.11f8b8","order":41,"width":"3","height":"1","passthru":false,"topic":"10_brightness","min":"1","max":"100","step":"","x":840,"y":900,"wires":[["2b9cec.6cfee314"]]},{"id":"d6b864ad.90e7","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_13/+pred/","label":"Ceiling","group":"f92ef285.8be6b","order":2,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"13_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1120,"wires":[["2b9cec.6cfee314"]]},{"id":"93be5b8b.d5c55","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_17/+pred/","label":"Vanity","group":"f92ef285.8be6b","order":8,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"17_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1280,"wires":[["2b9cec.6cfee314"]]},{"id":"637f5dcf.b94644","type":"ui_switch","z":"5a05b8f3.894b88","name":"Water Pump /pump_out/","label":"Pump","group":"cae5b35a.e3024","order":1,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"93_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":870,"y":2480,"wires":[["2b9cec.6cfee314"]]},{"id":"c98e1ecb.d971d8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Elec Water Heat /elecheat_out/","label":"Electric","group":"cae5b35a.e3024","order":5,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"23_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":850,"y":2560,"wires":[["2b9cec.6cfee314","fd50868f.d25368"]]},{"id":"6ed2f25c.9b5cb4","type":"ui_switch","z":"5a05b8f3.894b88","name":"Fuel Water Heat /fuelheat_out/","label":"Fuel","group":"cae5b35a.e3024","order":6,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"24_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":850,"y":2520,"wires":[["2b9cec.6cfee314"]]},{"id":"8b4bfcc0.e943c8","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_28/+pred/","label":"Ceiling","group":"71f15ecb.66179","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"28_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1720,"wires":[["2b9cec.6cfee314"]]},{"id":"e83821db.4db18","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_21/+pred/","label":"Road","group":"4e2af34d.8f765c","order":40,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"21_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1440,"wires":[["2b9cec.6cfee314"]]},{"id":"94997def.bc00f","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/3","qos":"0","broker":"c1170463.5c7f8","x":150,"y":320,"wires":[["9b24d1f5.16c55"]]},{"id":"dcd1dd69.6b88e8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/4","qos":"0","broker":"c1170463.5c7f8","x":150,"y":400,"wires":[["6e66b523.d3213c"]]},{"id":"bcbe9f30.8997b8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/6","qos":"0","broker":"c1170463.5c7f8","x":150,"y":560,"wires":[["48ba5fa7.733b1"]]},{"id":"be4844ec.4d88e8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/7","qos":"0","broker":"c1170463.5c7f8","x":150,"y":640,"wires":[["704f4d41.50fa54"]]},{"id":"fcc9e896.4ff07","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/8","qos":"0","broker":"c1170463.5c7f8","x":150,"y":720,"wires":[["10cb22c8.dbffad"]]},{"id":"cdd86688.7e2b4","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/9","qos":"0","broker":"c1170463.5c7f8","x":150,"y":800,"wires":[["35623104.63cf5e"]]},{"id":"4352ebec.6c8734","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/10","qos":"0","broker":"c1170463.5c7f8","x":160,"y":880,"wires":[["9a7441fa.80371"]]},{"id":"c4f28dec.12421","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/11","qos":"0","broker":"c1170463.5c7f8","x":160,"y":960,"wires":[["9b4ab7bf.f2a028"]]},{"id":"ef7c89aa.d895e8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/12","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1040,"wires":[["b38620e7.ca078"]]},{"id":"3513dbdc.204354","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/13","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1120,"wires":[["2d1644ca.88801c"]]},{"id":"c4fab844.024bc8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/14","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1160,"wires":[["954fca3c.713728"]]},{"id":"ccb710bd.ac6318","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/15","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1200,"wires":[["691546ca.f35808"]]},{"id":"f1401929.f8aff8","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/16","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1240,"wires":[["a1bb8cfa.065bd"]]},{"id":"9767c9ed.62373","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/17","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1280,"wires":[["6fe76ebc.77282"]]},{"id":"e58035a7.f3d3f","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/19","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1360,"wires":[["727a6203.75b2ac"]]},{"id":"f9ad487e.96c1f","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/21","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1440,"wires":[["ab2b6263.ee1b"]]},{"id":"2498fded.f08a32","type":"mqtt in","z":"5a05b8f3.894b88","name":"/elecheat_in/","topic":"RVC/DC_DIMMER_STATUS_3/23","qos":"0","broker":"c1170463.5c7f8","x":110,"y":2560,"wires":[["1bd75c83.f0b843"]]},{"id":"3dab7c81.f0fcdc","type":"mqtt in","z":"5a05b8f3.894b88","name":"/fuelheat_in/","topic":"RVC/DC_DIMMER_STATUS_3/24","qos":"0","broker":"c1170463.5c7f8","x":110,"y":2520,"wires":[["3632b964.74aed6"]]},{"id":"883a36ed.a73ee","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/28","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1720,"wires":[["517f7e0e.4cf6c"]]},{"id":"cd54bb31.376898","type":"mqtt in","z":"5a05b8f3.894b88","name":"/pump_in/","topic":"RVC/DC_DIMMER_STATUS_3/93","qos":"0","broker":"c1170463.5c7f8","x":100,"y":2480,"wires":[["8f0a15f8.272588"]]},{"id":"9cee87d0.a0a43","type":"mqtt in","z":"5a05b8f3.894b88","name":"/galley-fan-mqtt/","topic":"RVC/DC_DIMMER_STATUS_3/25","qos":"0","broker":"c1170463.5c7f8","x":2780,"y":1400,"wires":[["615c2c3f.a6b5b4"]]},{"id":"f0bc266a.d81d4","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/vent_lid.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"vent_lid.pl","x":4240,"y":1580,"wires":[[],[],[]]},{"id":"73925679.728a08","type":"ui_button","z":"5a05b8f3.894b88","name":"/entry-unlock/","group":"f6ae28b7.041968","order":6,"width":"3","height":"1","passthru":false,"label":"Unlock","color":"","bgcolor":"","icon":"fa-unlock","payload":"0","payloadType":"str","topic":"1","x":1460,"y":980,"wires":[["49eafa.00923508"]]},{"id":"7e1d595d.b09b2","type":"ui_button","z":"5a05b8f3.894b88","name":"/entry-lock/","group":"f6ae28b7.041968","order":5,"width":"3","height":"1","passthru":false,"label":"Lock","color":"","bgcolor":"","icon":"fa-lock","payload":"1","payloadType":"str","topic":"1","x":1470,"y":1020,"wires":[["49eafa.00923508"]]},{"id":"d89a399f.b2ddd8","type":"ui_button","z":"5a05b8f3.894b88","name":"/cargo-unlock/","group":"f6ae28b7.041968","order":9,"width":"3","height":"1","passthru":false,"label":"Unlock","color":"","bgcolor":"","icon":"fa-unlock","payload":"0","payloadType":"str","topic":"6","x":1460,"y":1100,"wires":[["49eafa.00923508"]]},{"id":"a6eb1e7.1674b6","type":"ui_button","z":"5a05b8f3.894b88","name":"/cargo-lock/","group":"f6ae28b7.041968","order":8,"width":"3","height":"1","passthru":false,"label":"Lock","color":"","bgcolor":"","icon":"fa-lock","payload":"1","payloadType":"str","topic":"6","x":1470,"y":1140,"wires":[["49eafa.00923508"]]},{"id":"62b3ea56.044ecc","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/locks.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"locks.pl /locks/+pred/","x":2180,"y":1000,"wires":[[],[],[]]},{"id":"6cf311eb.be1fb","type":"mqtt in","z":"5a05b8f3.894b88","name":"/ceilfan_low/","topic":"RVC/DC_DIMMER_STATUS_3/35","qos":"0","broker":"c1170463.5c7f8","x":2770,"y":1880,"wires":[["8c0ff247.bec05"]]},{"id":"b33e1979.0ba1d8","type":"mqtt in","z":"5a05b8f3.894b88","name":"/ceilfan_high/","topic":"RVC/DC_DIMMER_STATUS_3/36","qos":"0","broker":"c1170463.5c7f8","x":2770,"y":1920,"wires":[["67653654.1bbe68"]]},{"id":"6a548eb1.bcfad8","type":"ui_slider","z":"5a05b8f3.894b88","name":"Ceiling Fan /ceilfan_switch/","label":"","group":"517030c5.11f8b8","order":92,"width":"3","height":"1","passthru":false,"topic":"1","min":0,"max":"2","step":"","x":3720,"y":1920,"wires":[["da9ed17a.7ba37"]]},{"id":"d0ecf0.77d59b1","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/ceiling_fan.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"ceiling_fan.pl /ceilfan/+pred/","x":4240,"y":1920,"wires":[[],[],[]]},{"id":"2327e8e3.dbe1f","type":"ui_switch","z":"5a05b8f3.894b88","name":"Galley Fan /galley-fan-sw/","label":"Fan","group":"bb6f833c.5c7e8","order":3,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"25","onvalue":"2","onvalueType":"num","onicon":"","oncolor":"","offvalue":"3","offvalueType":"num","officon":"","offcolor":"","x":3710,"y":1400,"wires":[["9827a588.93a228"]]},{"id":"e813869b.d3f3b8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Galley Lid /galley-lid-sw/","label":"Vent Lid","group":"bb6f833c.5c7e8","order":2,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"26 27 39","onvalue":"69","onvalueType":"num","onicon":"","oncolor":"","offvalue":"133","offvalueType":"num","officon":"","offcolor":"","x":3710,"y":1440,"wires":[["377a6668.f0166a"]]},{"id":"befd7fa1.f282c8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Mid Fan /mid-fan-sw/","label":"Fan","group":"bb6f833c.5c7e8","order":6,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"29","onvalue":"2","onvalueType":"num","onicon":"","oncolor":"","offvalue":"3","offvalueType":"num","officon":"","offcolor":"","x":3700,"y":1540,"wires":[["a16da173.42902"]]},{"id":"ad76359.ef302c8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Mid Lid /mid-lid-sw/","label":"Vent Lid","group":"bb6f833c.5c7e8","order":5,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"30 31 54","onvalue":"69","onvalueType":"num","onicon":"","oncolor":"","offvalue":"133","offvalueType":"num","officon":"","offcolor":"","x":3700,"y":1580,"wires":[["cdf137d9.e46f98"]]},{"id":"180fe239.89b066","type":"ui_switch","z":"5a05b8f3.894b88","name":"Rear Fan /rear-fan-sw/","label":"Fan","group":"bb6f833c.5c7e8","order":9,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"32","onvalue":"2","onvalueType":"num","onicon":"","oncolor":"","offvalue":"3","offvalueType":"num","officon":"","offcolor":"","x":3700,"y":1680,"wires":[["5a98a135.be91b"]]},{"id":"9bf5e696.1372f8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Rear Lid /rear-lid-sw/","label":"Vent Lid","group":"bb6f833c.5c7e8","order":8,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"33 34 114","onvalue":"69","onvalueType":"num","onicon":"","oncolor":"","offvalue":"133","offvalueType":"num","officon":"","offcolor":"","x":3700,"y":1720,"wires":[["393df8b6.9f3828"]]},{"id":"fde339a0.7cf7","type":"ui_button","z":"5a05b8f3.894b88","name":"/all-unlock/","group":"f6ae28b7.041968","order":3,"width":"3","height":"1","passthru":false,"label":"Unlock","color":"","bgcolor":"","icon":"fa-unlock","payload":"0","payloadType":"str","topic":"0","x":1470,"y":860,"wires":[["49eafa.00923508"]]},{"id":"35ee5a13.541cb6","type":"ui_button","z":"5a05b8f3.894b88","name":"/all-lock/","group":"f6ae28b7.041968","order":2,"width":"3","height":"1","passthru":false,"label":"Lock","color":"","bgcolor":"","icon":"fa-lock","payload":"1","payloadType":"str","topic":"0","x":1480,"y":900,"wires":[["49eafa.00923508"]]},{"id":"9466733.a8a561","type":"ui_template","z":"5a05b8f3.894b88","group":"f6ae28b7.041968","name":"All Locks","order":1,"width":"","height":"","format":"<!DOCTYPE html>\n<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;overflow:hidden;\">\n    All\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1480,"y":820,"wires":[["49eafa.00923508"]]},{"id":"db246d2e.857918","type":"ui_template","z":"5a05b8f3.894b88","group":"f6ae28b7.041968","name":"Entrance Door","order":4,"width":"","height":"","format":"<!DOCTYPE html>\n<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left;\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;overflow:hidden;\">\n    Entrance Door\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>\n","storeOutMessages":true,"fwdInMessages":true,"x":1460,"y":940,"wires":[["49eafa.00923508"]]},{"id":"6ce45de7.95ff2c","type":"ui_template","z":"5a05b8f3.894b88","group":"f6ae28b7.041968","name":"Cargo Bays","order":7,"width":"","height":"","format":"<!DOCTYPE html>\n<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;overflow:hidden;\">\n    Cargo Bays\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"x":1470,"y":1060,"wires":[["49eafa.00923508"]]},{"id":"567823e.700885c","type":"ui_template","z":"5a05b8f3.894b88","group":"bb6f833c.5c7e8","name":"Galley Vent Label","order":1,"width":"","height":"","format":"<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    Galley\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":3690,"y":1360,"wires":[["9827a588.93a228"]]},{"id":"aa1364bc.46c968","type":"ui_template","z":"5a05b8f3.894b88","group":"bb6f833c.5c7e8","name":"Mid Bath Vent Label","order":4,"width":"","height":"","format":"<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    Mid Bath\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":3700,"y":1500,"wires":[["a16da173.42902"]]},{"id":"84cdad63.529c98","type":"ui_template","z":"5a05b8f3.894b88","group":"bb6f833c.5c7e8","name":"Rear Bath Vent Label","order":7,"width":"","height":"","format":"<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    Rear Bath\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":3700,"y":1640,"wires":[["5a98a135.be91b"]]},{"id":"d9f0c30b.5a865","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"CP/TANK_STATUS/Fresh","qos":"2","broker":"c1170463.5c7f8","x":310,"y":3620,"wires":[["f350bf6f.91161"]]},{"id":"72a77d4d.b70dbc","type":"ui_text","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","order":2,"width":"2","height":"1","name":"Fresh:","label":"Fresh","format":"{{msg.payload}}%","layout":"col-center","x":730,"y":3620,"wires":[]},{"id":"44c283a8.34eebc","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"CP/TANK_STATUS/Grey","qos":"2","broker":"c1170463.5c7f8","x":310,"y":3660,"wires":[["b5d0e09f.8e198"]]},{"id":"418bd951.4eb67","type":"ui_text","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","order":3,"width":"2","height":"1","name":"Grey:","label":"Grey","format":"{{msg.payload}}%","layout":"col-center","x":730,"y":3660,"wires":[]},{"id":"54c15885.cc5ca","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"CP/TANK_STATUS/Black","qos":"2","broker":"c1170463.5c7f8","x":310,"y":3700,"wires":[["76d3f82c.3278b8"]]},{"id":"a47ac593.4ed008","type":"ui_text","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","order":4,"width":"2","height":"1","name":"Black:","label":"Black","format":"{{msg.payload}}%","layout":"col-center","x":730,"y":3700,"wires":[]},{"id":"9791bcf6.b8f638","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"CP/GENERATOR_STATUS","qos":"2","broker":"c1170463.5c7f8","x":290,"y":3920,"wires":[["cd976c85.83861"]]},{"id":"72ef6a2f.590cdc","type":"ui_switch","z":"5a05b8f3.894b88","name":"Gen Controls Enable","label":"Gen Controls Enable","group":"a4a573ee.d6bdf","order":3,"width":"6","height":"1","passthru":false,"decouple":"false","topic":"genstartenable","onvalue":"1","onvalueType":"num","onicon":"","oncolor":"","offvalue":"0","offvalueType":"num","officon":"","offcolor":"","x":1010,"y":4400,"wires":[["caa4aa9b.d6b008"]]},{"id":"b5543be8.394ec8","type":"ui_button","z":"5a05b8f3.894b88","name":"Start Generator","group":"a4a573ee.d6bdf","order":4,"width":"3","height":"1","label":"Start Gen","color":"","icon":"fa-repeat","payload":"1","payloadType":"str","topic":"generator","x":990,"y":4468,"wires":[["caa4aa9b.d6b008"]]},{"id":"994b4acd.107d2","type":"ui_button","z":"5a05b8f3.894b88","name":"Stop Generator","group":"a4a573ee.d6bdf","order":5,"width":"3","height":"1","label":"Stop Gen","color":"","icon":"fa-stop","payload":"0","payloadType":"str","topic":"generator","x":990,"y":4504.5,"wires":[["caa4aa9b.d6b008"]]},{"id":"d833682c.3e8508","type":"inject","z":"5a05b8f3.894b88","name":"Check Gen Start Enabled Timer","topic":"checkgenenable","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":297,"y":4408,"wires":[["a68e7ccb.63a44"]]},{"id":"5ff865b5.d4fae4","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/generator.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"generator.pl /gencontrol/+pred/","x":1490,"y":4440,"wires":[["73737c10.325eac"],[],[]]},{"id":"4251713d.675418","type":"ui_slider","z":"5a05b8f3.894b88","name":"Brightness","label":"","group":"d944623c.5b46b8","order":5,"width":"3","height":"1","passthru":false,"outs":"all","topic":"","min":"1","max":"100","step":"","x":2010,"y":100,"wires":[["10e80e93.5f0211"]]},{"id":"f9363c14.d66b","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/panel_lights.pl ","addpay":true,"append":"","useSpawn":"","name":"","x":2430,"y":80,"wires":[[],[],[]]},{"id":"da91aa38.849028","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"CP/IGNITION","qos":"2","broker":"c1170463.5c7f8","x":270,"y":3840,"wires":[["555e9ef4.cfe45"]]},{"id":"efa73c57.fe0448","type":"ui_text","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","order":8,"width":"3","height":"1","name":"Ignition /ignition/+pred/","label":"Ignition","format":"{{msg.payload}}","layout":"col-center","x":790,"y":3840,"wires":[]},{"id":"9ee193c3.f6d9f8","type":"ui_switch","z":"5a05b8f3.894b88","name":"Panel Lights","label":"Panels","group":"d944623c.5b46b8","order":4,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"","onvalue":"100","onvalueType":"num","onicon":"","oncolor":"","offvalue":"0","offvalueType":"num","officon":"","offcolor":"","x":2010,"y":60,"wires":[["10e80e93.5f0211"]]},{"id":"b68c8b7c.d9bdb","type":"ui_template","z":"5a05b8f3.894b88","group":"a4a573ee.d6bdf","name":"Generator Note","order":1,"width":"0","height":"0","format":"<div>\n<p>\nAs a safety precaution for operating the generator,\nyou must turn on 'Gen Controls Enable', then press\n'Start Gen' or 'Stop Gen' within 5 seconds.\nGenerator may take up to 60 seconds to start.\n</p>\n<p>&nbsp;</p>\n</div>\n","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":990.5000114440918,"y":4433.750005722046,"wires":[["caa4aa9b.d6b008"]]},{"id":"79a50935.763808","type":"ui_template","z":"5a05b8f3.894b88","group":"a4a573ee.d6bdf","name":"Gen Start Status","order":6,"width":"","height":"","format":"<div layout=\"row\" layout-align=\"center center\"><b>{{msg.payload}}</b></div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1000,"y":4541,"wires":[["caa4aa9b.d6b008"]]},{"id":"89272dac.c0747","type":"mqtt in","z":"5a05b8f3.894b88","name":"GenStart Message","topic":"GENSTART/MESSAGE","broker":"c1170463.5c7f8","x":363,"y":4541,"wires":[["6de4b0ab.83a33"]]},{"id":"73737c10.325eac","type":"delay","z":"5a05b8f3.894b88","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1720,"y":4440,"wires":[["11ac0817.4d68f"]]},{"id":"11ac0817.4d68f","type":"template","z":"5a05b8f3.894b88","name":"Blank","field":"payload","fieldType":"msg","format":"handlebars","syntax":"plain","template":"","x":667,"y":4502,"wires":[["c3a72e26.0072f"]]},{"id":"37f7ef2e.907208","type":"inject","z":"5a05b8f3.894b88","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":476,"y":4502,"wires":[["11ac0817.4d68f"]]},{"id":"d1486c83.b98ce8","type":"ui_button","z":"5a05b8f3.894b88","name":"Mem On","group":"d944623c.5b46b8","order":1,"width":"2","height":"1","passthru":false,"label":"Mem On","color":"","bgcolor":"","icon":"","payload":"1","payloadType":"str","topic":"master","x":1700,"y":240,"wires":[["a4f9a80d.d8f2a"]]},{"id":"a4f9a80d.d8f2a","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/master.pl","addpay":true,"append":"1 2 3 4 6 7 8 9 10 11 12 13 14 15 16 17 19 28","useSpawn":"","timer":"","oldrc":false,"name":"","x":1940,"y":240,"wires":[[],[],[]]},{"id":"79af75e.49c4c8c","type":"ui_button","z":"5a05b8f3.894b88","name":"All Off","group":"d944623c.5b46b8","order":3,"width":"2","height":"1","passthru":false,"label":"All Off","color":"","bgcolor":"","icon":"","payload":"0","payloadType":"str","topic":"master","x":1691,"y":281,"wires":[["a4f9a80d.d8f2a"]]},{"id":"4b03da62.b8a3d4","type":"ui_template","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","name":"Tanks","order":1,"format":"<!DOCTYPE html>\n<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    Tanks\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"x":730,"y":3520,"wires":[[]]},{"id":"f5333ce8.df1fa","type":"ui_template","z":"5a05b8f3.894b88","group":"fb4c3e00.5737a","name":"12V Power Label","order":1,"width":"","height":"","format":"<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    12V Power\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":450,"y":2720,"wires":[[]]},{"id":"787d153b.a17b74","type":"ui_text","z":"5a05b8f3.894b88","group":"a4a573ee.d6bdf","order":2,"width":"6","height":"1","name":"Generator State /genstatus/+pred/","label":"Status","format":"{{msg.payload}}","layout":"","x":920,"y":3920,"wires":[]},{"id":"9634a554.eba588","type":"ui_button","z":"2fdd8124.05e35e","name":"Shutdown","group":"f961f048.b0646","order":6,"width":"3","height":"1","passthru":false,"label":"Shutdown","color":"","bgcolor":"","icon":"fa-power-off","payload":"","payloadType":"str","topic":"shutdown","x":730,"y":3140,"wires":[["415af2a8.5a947c"]]},{"id":"415af2a8.5a947c","type":"exec","z":"2fdd8124.05e35e","command":"sudo /coachproxy/bin/safe_shutdown","addpay":false,"append":"","useSpawn":"","name":"","x":1000,"y":3140,"wires":[[],[],[]]},{"id":"4c3ea3a.8a313dc","type":"ui_button","z":"2fdd8124.05e35e","name":"Reboot","group":"f961f048.b0646","order":5,"width":"3","height":"1","label":"Reboot","color":"","icon":"fa-repeat","payload":"","payloadType":"str","topic":"reboot","x":730,"y":3080,"wires":[["14f6b812.2c4f78"]]},{"id":"14f6b812.2c4f78","type":"exec","z":"2fdd8124.05e35e","command":"sudo /coachproxy/bin/safe_reboot","addpay":false,"append":"","useSpawn":"","name":"","x":990,"y":3080,"wires":[[],[],[]]},{"id":"2c3ffc9c.ac652c","type":"ui_text","z":"2fdd8124.05e35e","group":"f961f048.b0646","order":7,"width":"","height":"","name":"Shutdown Feedback","label":"","format":"{{msg.payload}}","layout":"col-center","x":950,"y":3200,"wires":[]},{"id":"edae305b.745bc","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/MESSAGE","qos":"0","broker":"c1170463.5c7f8","x":130,"y":320,"wires":[["2efaba3c.f2b586"]]},{"id":"4c937d76.07d3cc","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/SN","qos":"0","broker":"c1170463.5c7f8","x":720,"y":2900,"wires":[["961203aa.9823c"]]},{"id":"961203aa.9823c","type":"ui_text","z":"2fdd8124.05e35e","group":"f961f048.b0646","order":2,"width":"","height":"","name":"Serial Number","label":"Serial Number","format":"{{msg.payload}}","layout":"","x":930,"y":2900,"wires":[]},{"id":"ed8f62b5.c7ed48","type":"ui_text","z":"2fdd8124.05e35e","group":"f961f048.b0646","order":1,"width":"","height":"","name":"CoachProxyOS Version","label":"CoachProxyOS Version","format":"{{msg.payload}}","layout":"","x":940,"y":2940,"wires":[]},{"id":"f47d0e1c.87d328","type":"inject","z":"2fdd8124.05e35e","name":"Every Minute","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":true,"onceDelay":"","x":310,"y":2980,"wires":[["e1ba3e99.4f13a"]]},{"id":"e1ba3e99.4f13a","type":"exec","z":"2fdd8124.05e35e","command":"date +%s -d \"$(uptime -s)\"","addpay":false,"append":"","useSpawn":"","name":"Uptime","x":510,"y":2980,"wires":[["3fcf94be.9ffbec"],[],[]]},{"id":"b6168986.1a2508","type":"ui_text","z":"2fdd8124.05e35e","group":"f961f048.b0646","order":3,"width":"","height":"","name":"Uptime","label":"Uptime","format":"{{msg.payload}}","layout":"","x":910,"y":2980,"wires":[]},{"id":"bcfdd5c3.eb51c","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/SHUTDOWN","qos":"0","broker":"c1170463.5c7f8","x":690,"y":3200,"wires":[["2c3ffc9c.ac652c"]]},{"id":"f5de6035.c61c58","type":"ui_text","z":"5a05b8f3.894b88","group":"517030c5.11f8b8","order":91,"width":"3","height":"1","name":"Ceiling Fan Label /ceilfan/ceilfan_label/+pred/","label":"Ceiling Fan: ","format":"{{msg.payload}}","layout":"col-center","x":3780,"y":1880,"wires":[]},{"id":"1d7a9c0d.1599ac","type":"ui_button","z":"5a05b8f3.894b88","name":"All On","group":"d944623c.5b46b8","order":2,"width":"2","height":"1","label":"All On","color":"","icon":"","payload":"2","payloadType":"str","topic":"master","x":1690.2857360839844,"y":199.5712890625,"wires":[["a4f9a80d.d8f2a"]]},{"id":"4514ad25.024a8c","type":"ui_text","z":"5a05b8f3.894b88","group":"cae5b35a.e3024","order":2,"width":"3","height":"1","name":"water-pump 3 spaces","label":"","format":"{{msg.payload}}","layout":"row-spread","x":720,"y":2440,"wires":[]},{"id":"555e9ef4.cfe45","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":570,"y":3840,"wires":[["efa73c57.fe0448"]]},{"id":"5b0c641c.f195ec","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":690,"y":3920,"wires":[["787d153b.a17b74"]]},{"id":"76d3f82c.3278b8","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":570,"y":3700,"wires":[["a47ac593.4ed008","f5adb9ac.093858"]]},{"id":"b5d0e09f.8e198","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":570,"y":3660,"wires":[["418bd951.4eb67","f5adb9ac.093858"]]},{"id":"f350bf6f.91161","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":570,"y":3620,"wires":[["72a77d4d.b70dbc","f5adb9ac.093858"]]},{"id":"53de9acd.7e63e4","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1400,"wires":[["2327e8e3.dbe1f"]]},{"id":"1701900f.a929f","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1440,"wires":[["e813869b.d3f3b8"]]},{"id":"248c268f.6aed3a","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1580,"wires":[["ad76359.ef302c8"]]},{"id":"7df49fe3.56c24","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1720,"wires":[["9bf5e696.1372f8"]]},{"id":"a9fbfba.4f20108","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1880,"wires":[["f5de6035.c61c58"]]},{"id":"a8a81666.21bc18","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1920,"wires":[["6a548eb1.bcfad8"]]},{"id":"c3a72e26.0072f","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":827,"y":4541,"wires":[["79a50935.763808"]]},{"id":"84e70031.58d4f","type":"template","z":"5a05b8f3.894b88","name":"2015-2018 Lock Command","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{topic}} {{payload}}","x":1920,"y":1000,"wires":[["62b3ea56.044ecc"]]},{"id":"da9ed17a.7ba37","type":"template","z":"5a05b8f3.894b88","name":"ceiling_fan_template","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{topic}} {{payload}}","x":3980,"y":1920,"wires":[["d0ecf0.77d59b1"]]},{"id":"cdd6982.46cd168","type":"file function","z":"5a05b8f3.894b88","name":"ceiling_fan_decode","filename":".node-red/js/ceiling_fan_decode.js","reloadfile":false,"outputs":"2","x":3330,"y":1900,"wires":[["a9fbfba.4f20108"],["a8a81666.21bc18"]]},{"id":"e914f9ad.d17de8","type":"file function","z":"5a05b8f3.894b88","name":"decode_fan.js","filename":".node-red/js/decode_fan.js","reloadfile":false,"outputs":1,"x":3340,"y":1400,"wires":[["53de9acd.7e63e4"]]},{"id":"2ccba559.56a8ea","type":"file function","z":"5a05b8f3.894b88","name":"decode_vent.js","filename":".node-red/js/decode_vent.js","reloadfile":false,"outputs":1,"x":3340,"y":1440,"wires":[["1701900f.a929f"]]},{"id":"dc6c25d3.b1e478","type":"file function","z":"5a05b8f3.894b88","name":"decode_vent.js","filename":".node-red/js/decode_vent.js","reloadfile":false,"outputs":1,"x":3340,"y":1580,"wires":[["248c268f.6aed3a"]]},{"id":"738623ec.d199fc","type":"file function","z":"5a05b8f3.894b88","name":"decode_vent.js","filename":".node-red/js/decode_vent.js","reloadfile":false,"outputs":1,"x":3340,"y":1720,"wires":[["7df49fe3.56c24"]]},{"id":"caa4aa9b.d6b008","type":"file function","z":"5a05b8f3.894b88","name":"genset_safety","filename":".node-red/js/genset_safety.js","reloadfile":false,"outputs":1,"x":1241.8572006225586,"y":4431.142890930176,"wires":[["5ff865b5.d4fae4"]]},{"id":"a68e7ccb.63a44","type":"file function","z":"5a05b8f3.894b88","name":"genset_countdown","filename":".node-red/js/genset_countdown.js","reloadfile":false,"outputs":"2","x":628.5714111328125,"y":4407.714597702026,"wires":[["72ef6a2f.590cdc"],["6de4b0ab.83a33"]]},{"id":"6de4b0ab.83a33","type":"file function","z":"5a05b8f3.894b88","name":"genset_clear_buffer","filename":".node-red/js/genset_clear_buffer.js","reloadfile":false,"outputs":1,"x":637.5714372907366,"y":4540.428774152482,"wires":[["c3a72e26.0072f"]]},{"id":"2efaba3c.f2b586","type":"change","z":"2fdd8124.05e35e","name":"Alert!","rules":[{"t":"set","p":"topic","pt":"msg","to":"Alert!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":320,"wires":[["d86399a0.0a9b08"]]},{"id":"3fcf94be.9ffbec","type":"file function","z":"2fdd8124.05e35e","name":"uptime_parse","filename":".node-red/js/uptime_parse.js","reloadfile":false,"outputs":1,"x":710,"y":2980,"wires":[["b6168986.1a2508"]]},{"id":"a19f1558.caa0f8","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_0_day_up/","group":"69274a36.07e384","order":21,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 day up 8","payloadType":"str","topic":"","x":2970,"y":2680,"wires":[["ed2d6b8.2241b98"]]},{"id":"c926072d.7ea398","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_0_day_down/","group":"69274a36.07e384","order":23,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 day down 8","payloadType":"str","topic":"","x":2980,"y":2720,"wires":[["ed2d6b8.2241b98"]]},{"id":"4972eaba.4e8024","type":"ui_template","z":"5a05b8f3.894b88","group":"69274a36.07e384","name":"P/S Dining /shade_0_label/","order":20,"width":"6","height":"1","format":"<div style=\"height: 14px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 18px; font-size: 16px; text-align: center\">\n<span>P/S Dining</span>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2960,"y":2640,"wires":[[]]},{"id":"1a1a258d.cde44a","type":"mqtt in","z":"5a05b8f3.894b88","name":"/galley-lid-mqtt/","topic":"RVC/DC_DIMMER_COMMAND_2/26","qos":"0","broker":"c1170463.5c7f8","x":2780,"y":1440,"wires":[["db18d704.757568"]]},{"id":"b6040359.c59e","type":"mqtt in","z":"5a05b8f3.894b88","name":"/mid-lid-mqtt/","topic":"RVC/DC_DIMMER_COMMAND_2/30","qos":"0","broker":"c1170463.5c7f8","x":2770,"y":1580,"wires":[["e2626070.a4c46"]]},{"id":"b2a5878f.521648","type":"mqtt in","z":"5a05b8f3.894b88","name":"/rear-lid-mqtt/","topic":"RVC/DC_DIMMER_COMMAND_2/33","qos":"0","broker":"c1170463.5c7f8","x":2770,"y":1720,"wires":[["bf38c6b9.0803e8"]]},{"id":"1c295a6.055fca6","type":"ui_template","z":"5a05b8f3.894b88","group":"87ed7eaa.ab8fe","name":"Chassis Label /chassislabel/","order":7,"width":"6","height":"1","format":"<!DOCTYPE html>\n<div style=\"height: 10px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 10px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;\">\n    Chassis: <b>{{msg.payload.source}}</b>\n  </span>\n</div>\n<div style=\"height: 8px;\">&nbsp;</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":800,"y":3800,"wires":[[]]},{"id":"9e0f3a97.242428","type":"comment","z":"5a05b8f3.894b88","name":"2017 Allegro_Bus 45_OP","info":"","x":120,"y":40,"wires":[]},{"id":"94b1f43e.8fc288","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1400,"wires":[["e914f9ad.d17de8"]]},{"id":"db84192e.531118","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1440,"wires":[["2ccba559.56a8ea"]]},{"id":"9be5525c.44dd3","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1580,"wires":[["dc6c25d3.b1e478"]]},{"id":"dd42ed8b.551b7","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1720,"wires":[["738623ec.d199fc"]]},{"id":"6ffd198e.82cac8","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/vent_fan_new.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"vent_fan_new.pl","x":4260,"y":1520,"wires":[[],[],[]]},{"id":"ed2d6b8.2241b98","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/window_shade.pl ","addpay":true,"append":"","useSpawn":"","name":"","x":3870,"y":3500,"wires":[[],[],[]]},{"id":"3d0470ed.386b4","type":"ui_chart","z":"5a05b8f3.894b88","name":"Tanks Bar Chart","group":"87ed7eaa.ab8fe","order":6,"width":0,"height":0,"label":"","chartType":"bar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"100","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#999999","#424242","#941100","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":980,"y":3560,"wires":[[],[]]},{"id":"1e3a7369.a0c48d","type":"ui_switch","z":"5a05b8f3.894b88","name":"Engine Pre-Heat /preheat_out/+pred/","label":"Engine Pre-Heat","group":"cae5b35a.e3024","order":7,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"92_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":830,"y":2600,"wires":[["2b9cec.6cfee314"]]},{"id":"3cfe3307.cc937c","type":"mqtt in","z":"5a05b8f3.894b88","name":"/preheat_in/","topic":"RVC/DC_DIMMER_STATUS_3/92","qos":"0","broker":"c1170463.5c7f8","x":110,"y":2600,"wires":[["5d128818.9a8018"]]},{"id":"14cc71e.056b78e","type":"comment","z":"5a05b8f3.894b88","name":"Window Shades","info":"","x":2960,"y":2600,"wires":[]},{"id":"e9d02061.5900d","type":"inject","z":"5a05b8f3.894b88","name":"Tank Chart Setup","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"0.1","x":290,"y":3560,"wires":[["12a8a80a.7a4e88"]]},{"id":"12a8a80a.7a4e88","type":"function","z":"5a05b8f3.894b88","name":"Tank Chart Setup","func":"var msgs = [\n    {topic: 'Fresh', payload: 0},\n    {topic: 'Grey', payload: 0},\n    {topic: 'Black', payload: 0},\n];\n\nreturn [msgs];","outputs":1,"noerr":0,"x":530,"y":3560,"wires":[["f5adb9ac.093858"]]},{"id":"c43b4452.61cbd8","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"low","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3110,"y":1880,"wires":[["cdd6982.46cd168"]]},{"id":"8667ee3f.a12b9","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"high","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3110,"y":1920,"wires":[["cdd6982.46cd168"]]},{"id":"62c61797.d365e8","type":"comment","z":"5a05b8f3.894b88","name":"Bedroom Ceiling Fan : Some of these nodes will be edited during auto-configuration.","info":"","x":2990,"y":1840,"wires":[]},{"id":"9d61ee0.f6fca1","type":"comment","z":"5a05b8f3.894b88","name":"Ceiling Vents and Fans : Some of these nodes will be edited during auto-configuration.","info":"","x":3020,"y":1360,"wires":[]},{"id":"ed601701.b776c8","type":"ui_template","z":"5a05b8f3.894b88","group":"cae5b35a.e3024","name":"Aqua-Hot Label /aquahot-label/","order":4,"width":"","height":"","format":"<!DOCTYPE html>\n<div style=\"height: 8px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 8px; border-bottom: 1px solid black; text-align: left\">\n  <span style=\"font-size: 16px; background-color: #FEFEFE; padding: 0 10px; margin-left: 10px;overflow: hidden;\">\n    Aqua-Hot\n  </span>\n</div>\n<div style=\"height: 11px;\">&nbsp;</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":470,"y":2440,"wires":[[]]},{"id":"29d34722.717808","type":"comment","z":"2fdd8124.05e35e","name":"System Tab","info":"","x":720,"y":2860,"wires":[]},{"id":"4f256116.a0922","type":"function","z":"f6c367c2.63b9b8","name":"Save Option","func":"// Save the user's selection for future use\nflow.set(msg.topic, msg.payload); ","outputs":1,"noerr":0,"x":1150,"y":760,"wires":[[]]},{"id":"6a460ddd.614d34","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Heated Floors","group":"dd373808.7ec1d8","order":3,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"floorheat","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":780,"y":640,"wires":[["4f256116.a0922"]]},{"id":"e17935c4.9179d8","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Aqua-Hot","group":"dd373808.7ec1d8","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"aquahot","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":760,"y":580,"wires":[["4f256116.a0922"]]},{"id":"d47744cb.8e65a8","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Third Air Conditioner Zone","group":"dd373808.7ec1d8","order":8,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"thirdtstat","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":820,"y":980,"wires":[["4f256116.a0922"]]},{"id":"ebfe21a.9252fe","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Ceiling Fan","group":"dd373808.7ec1d8","order":4,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"ceilfan","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":770,"y":700,"wires":[["4f256116.a0922"]]},{"id":"dc84eec5.90206","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"TV Lift","group":"dd373808.7ec1d8","order":5,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"tvlift","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":750,"y":780,"wires":[["4f256116.a0922"]]},{"id":"3e7decdc.b1a0f4","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Bus Undercoach Light (2018+)","group":"dd373808.7ec1d8","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"busundercoach","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":830,"y":840,"wires":[["4f256116.a0922"]]},{"id":"a5725878.456328","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Second Furnace Zone","group":"dd373808.7ec1d8","order":9,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"secondfurnace","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":800,"y":1060,"wires":[["4f256116.a0922"]]},{"id":"d1929547.5808b8","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Heated Floors","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.floorheat = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":640,"wires":[["6a460ddd.614d34"]]},{"id":"a11e14a2.3f8368","type":"function","z":"f6c367c2.63b9b8","name":"Set Aqua-Hot","func":"// Populate the \"Aqua-Hot\" toggle based on the chosen model.\n\nvar aquahot_standard = ['Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '' };\n\nif (flow.get('model')) {\n    if (aquahot_standard.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n} else {\n    msg = null;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":600,"wires":[["e17935c4.9179d8"]]},{"id":"9367e589.40dcc8","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Aquahot","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.aquahot = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":560,"wires":[["e17935c4.9179d8"]]},{"id":"52b131c0.3e0bc","type":"function","z":"f6c367c2.63b9b8","name":"Set Third Tstat","func":"// Populate the \"Number of Thermostats\" toggle based on the chosen model.\n\nvar third_zone = ['Phaeton', 'Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '', enabled: true };\n\nif (flow.get('model')) {\n    if (third_zone.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n}\n\nif (flow.get('year') < 2018 && flow.get('model').substr(0,8) != 'VanLeigh') {\n    msg.enabled = false;\n    msg.payload = false;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":1000,"wires":[["d47744cb.8e65a8"]]},{"id":"96cb49b8.8b8178","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Third Tstat","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.thirdtstat = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":960,"wires":[["d47744cb.8e65a8"]]},{"id":"d7334b34.c939a8","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Ceiling Fan","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.ceilfan = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":680,"wires":[["ebfe21a.9252fe"]]},{"id":"c850c110.ae628","type":"function","z":"f6c367c2.63b9b8","name":"Set Ceiling Fan","func":"// Populate the \"Ceiling Fan\" toggle based on the chosen model.\n\nvar ceilfan_standard = ['Phaeton', 'Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '' };\n\nif (flow.get('model')) {\n    if (ceilfan_standard.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n} else {\n    msg = null;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":720,"wires":[["ebfe21a.9252fe"]]},{"id":"9b73dccc.9604f","type":"function","z":"f6c367c2.63b9b8","name":"Set TV Lift","func":"// Populate the \"TV Lift\" toggle based on the chosen model.\n\nvar tvlift = ['37_BH', '40_IH', '44_OH', '45_MP', '45_OPP', '45_PZ'];\nvar msg = { topic: '', payload: '' };\n\nmsg.payload = tvlift.includes(flow.get('floorplan'));\n\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":800,"wires":[["dc84eec5.90206"]]},{"id":"e55635a0.d71c08","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved TV Lift","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.tvlift = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":760,"wires":[["dc84eec5.90206"]]},{"id":"339d95b3.f8e70a","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Under Light","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.busundercoach = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":840,"wires":[["3e7decdc.b1a0f4"]]},{"id":"fae26113.b499f","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Second Furnace","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.secondfurnace = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1040,"wires":[["a5725878.456328"]]},{"id":"415cf9bf.4a48f8","type":"link in","z":"f6c367c2.63b9b8","name":"Stored Configs Out","links":["f064e789.8ee718"],"x":95,"y":440,"wires":[["4dfe1b9e.8930a4","9367e589.40dcc8","d1929547.5808b8","d7334b34.c939a8","e55635a0.d71c08","96cb49b8.8b8178","4e592cfc.f31974","339d95b3.f8e70a","fae26113.b499f","3d01252.b8a7ada","c55f7e9a.5b269","bb656f06.c9eb4","d6e99aed.9f4498","4eb415af.b6f65c","f900b347.058da"]]},{"id":"9f2c8e4f.b0e94","type":"link in","z":"f6c367c2.63b9b8","name":"Coach Config Changed - Out","links":["8b7ede7f.8f951"],"x":95,"y":740,"wires":[["a11e14a2.3f8368","52b131c0.3e0bc","9adc4e9b.8e2d2","9b73dccc.9604f","c850c110.ae628","98b23545.c429e8","b28430f0.302e8","5dff0e93.907d5"]]},{"id":"4dfe1b9e.8930a4","type":"delay","z":"f6c367c2.63b9b8","name":"","pauseType":"delay","timeout":"750","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":480,"wires":[["7fdd649c.54de1c"]]},{"id":"b33f57fb.ddb3c8","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Model","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.model","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":420,"wires":[["25d3ff72.475b8"]]},{"id":"8466b73c.6d83f8","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Year","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.year","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":360,"wires":[["6303f680.65dfe8"]]},{"id":"4e592cfc.f31974","type":"change","z":"f6c367c2.63b9b8","name":"Buttons Enabled?","rules":[{"t":"set","p":"enabled","pt":"msg","to":"payload.floorplan != null","tot":"jsonata"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":1560,"wires":[["66a1a845.bdd5e8"]]},{"id":"9adc4e9b.8e2d2","type":"change","z":"f6c367c2.63b9b8","name":"Buttons Enabled?","rules":[{"t":"set","p":"enabled","pt":"msg","to":"$flowContext('floorplan') != ''","tot":"jsonata"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":1600,"wires":[["66a1a845.bdd5e8"]]},{"id":"7fdd649c.54de1c","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Floor Plan","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.floorplan","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":480,"wires":[["21735e3b.c9fa92"]]},{"id":"25d3ff72.475b8","type":"ui_dropdown","z":"f6c367c2.63b9b8","name":"Model Menu","label":"","place":"Coach model","group":"39ecc94c.7e22c6","order":4,"width":"0","height":"0","passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"model","x":770,"y":420,"wires":[["c14463eb.5b67e"]]},{"id":"6303f680.65dfe8","type":"ui_dropdown","z":"f6c367c2.63b9b8","name":"Year Menu","label":"","place":"Coach year","group":"39ecc94c.7e22c6","order":3,"width":"0","height":"0","passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"year","x":770,"y":360,"wires":[["5da86ad4.9ce744"]]},{"id":"66a1a845.bdd5e8","type":"ui_button","z":"f6c367c2.63b9b8","name":"Save and Install","group":"e1a5049d.4cee88","order":2,"width":0,"height":0,"passthru":false,"label":"Save and Install","color":"","bgcolor":"","icon":"fa-check","payload":"","payloadType":"str","topic":"save","x":790,"y":1580,"wires":[["67d471e1.e9d42","956586e8.3221f8","d61ef8cb.9169a8","6504b8c0.3a9508"]]},{"id":"21735e3b.c9fa92","type":"ui_dropdown","z":"f6c367c2.63b9b8","name":"Floor Plan Menu","label":"","place":"Coach floor plan","group":"39ecc94c.7e22c6","order":5,"width":"0","height":"0","passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"floorplan","x":780,"y":480,"wires":[["5da0435a.8fc65c"]]},{"id":"c14463eb.5b67e","type":"change","z":"f6c367c2.63b9b8","name":"Save Model","rules":[{"t":"set","p":"model","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":420,"wires":[["8b7ede7f.8f951","4c222ef8.3b6f2"]]},{"id":"5da86ad4.9ce744","type":"change","z":"f6c367c2.63b9b8","name":"Save Year","rules":[{"t":"set","p":"year","pt":"flow","to":"$number(msg.payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":360,"wires":[["8b7ede7f.8f951","e166715c.d96cc"]]},{"id":"67d471e1.e9d42","type":"function","z":"f6c367c2.63b9b8","name":"Save to Database","func":"// Save the global config settings to the database\n\nvar msgs = [];  // An array of database query messages\n\nfor (var item of ['year', 'model', 'floorplan', 'aquahot', 'floorheat', 'ceilfan', 'tvlift', 'thirdtstat', 'secondfurnace', 'midheat', 'rearheat', 'busundercoach', 'powerbed', 'shades_interior']) {\n    var newmsg = {};\n    newmsg.topic = 'INSERT OR REPLACE INTO configs (key, value) VALUES(?, ?)';\n    newmsg.payload = [item, String(flow.get(item))];\n    msgs.push(newmsg);\n}\n\nreturn [msgs, {payload: 'Saving changes...'}];","outputs":2,"noerr":0,"x":1070,"y":1560,"wires":[["c2127265.468ad"],["426d2ff7.9aa5f"]],"outputLabels":["array of queries","feedback message"]},{"id":"956586e8.3221f8","type":"delay","z":"f6c367c2.63b9b8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1600,"wires":[["430d058c.29f94c","7cd87312.e8638c"]]},{"id":"d61ef8cb.9169a8","type":"change","z":"f6c367c2.63b9b8","name":"Disable Button","rules":[{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":1660,"wires":[["66a1a845.bdd5e8"]]},{"id":"6504b8c0.3a9508","type":"delay","z":"f6c367c2.63b9b8","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":630,"y":1700,"wires":[["fc78cf2.39df13","60ea3bd5.a290b4"]]},{"id":"fc78cf2.39df13","type":"change","z":"f6c367c2.63b9b8","name":"Enable Button","rules":[{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":1700,"wires":[["66a1a845.bdd5e8"]]},{"id":"5da0435a.8fc65c","type":"function","z":"f6c367c2.63b9b8","name":"Save Floor Plan","func":"// Save the user's selection for future use\nif (msg.payload !== '') {\n    flow.set('floorplan', msg.payload);\n    return msg;\n}","outputs":1,"noerr":0,"x":1000,"y":480,"wires":[["8b7ede7f.8f951"]]},{"id":"8b7ede7f.8f951","type":"link out","z":"f6c367c2.63b9b8","name":"Coach Config Changed - In","links":["9f2c8e4f.b0e94","6ec94471.102c8c","c8c58e81.c105a"],"x":1135,"y":480,"wires":[]},{"id":"c2127265.468ad","type":"sqlite","z":"f6c367c2.63b9b8","mydb":"b9bfcd9c.3c935","name":"","x":1340,"y":1540,"wires":[[]]},{"id":"426d2ff7.9aa5f","type":"ui_text","z":"f6c367c2.63b9b8","group":"e1a5049d.4cee88","order":3,"width":0,"height":0,"name":"Feedback Text","label":"","format":"{{msg.payload}}","layout":"row-center","x":1670,"y":1560,"wires":[]},{"id":"430d058c.29f94c","type":"exec","z":"f6c367c2.63b9b8","command":"/coachproxy/configurator/cp_config.pl --habridge","addpay":false,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"","x":1350,"y":1600,"wires":[[],[],[]]},{"id":"7cd87312.e8638c","type":"change","z":"f6c367c2.63b9b8","name":"Message: Building configuration...","rules":[{"t":"set","p":"payload","pt":"msg","to":"Building configuration...","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1360,"y":1640,"wires":[["426d2ff7.9aa5f"]]},{"id":"60ea3bd5.a290b4","type":"change","z":"f6c367c2.63b9b8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":1740,"wires":[["426d2ff7.9aa5f"]]},{"id":"b9c3efcf.5b28","type":"change","z":"f6c367c2.63b9b8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1460,"wires":[["426d2ff7.9aa5f"]]},{"id":"7439d0ba.87459","type":"ui_ui_control","z":"f6c367c2.63b9b8","name":"Update when tab is displayed","x":190,"y":160,"wires":[["1f4566f5.e96699","b54d8c76.440fd"]]},{"id":"1f4566f5.e96699","type":"template","z":"f6c367c2.63b9b8","name":"Load Configs","field":"topic","fieldType":"msg","format":"handlebars","syntax":"plain","template":"select * from configs;","output":"str","x":440,"y":160,"wires":[["56106b2a.7d2784"]]},{"id":"56106b2a.7d2784","type":"sqlite","z":"f6c367c2.63b9b8","mydb":"b9bfcd9c.3c935","name":"coachproxy.sqlite","x":650,"y":160,"wires":[["13e55d69.864273"]]},{"id":"13e55d69.864273","type":"function","z":"f6c367c2.63b9b8","name":"Parse Configs","func":"// msg.payload = msg.payload[0];\n// return msg;\n\nvar payload = {};\nfor (var i = 0; i < (msg.payload).length; i++) {\n    var key = msg.payload[i].key;\n    var val = msg.payload[i].value;\n    flow.set(key, val);\n    if (val !== '') {\n        payload[key] = val;\n    }\n}\n\nmsg.payload = payload;\nreturn msg;","outputs":1,"noerr":0,"x":860,"y":160,"wires":[["f064e789.8ee718"]]},{"id":"f064e789.8ee718","type":"link out","z":"f6c367c2.63b9b8","name":"Stored Configs In","links":["415cf9bf.4a48f8","a9afea44.76da08"],"x":995,"y":160,"wires":[]},{"id":"53414f0e.6d8a","type":"ui_template","z":"f6c367c2.63b9b8","group":"39ecc94c.7e22c6","name":"CoachProxy Logo","order":1,"width":"6","height":"3","format":"<img src=\"CoachProxy_logo.jpg\">","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":490,"y":280,"wires":[[]]},{"id":"805121eb.01323","type":"ui_template","z":"f6c367c2.63b9b8","group":"dd373808.7ec1d8","name":"Configuration Message","order":1,"width":"0","height":"0","format":"<div style=\"height: 150px;\">\n<p>\n    Next, confirm the configuration options below are\n    correct for your coach.\n</p>\n<p>\n    <br>\n    Some options are only relevant to specific years\n    (e.g. thermostats) or models (e.g. undercoach lights).\n</p>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":810,"y":540,"wires":[[]]},{"id":"21500205.ffa20e","type":"ui_template","z":"f6c367c2.63b9b8","group":"39ecc94c.7e22c6","name":"Welcome Message","order":2,"width":"0","height":"0","format":"<div style=\"height: 130px;\">\n<p>\n    Welcome to CoachProxyOS!\n</p>\n<p>\n    <br>\n    Please select your year, model, and floor plan\n    below to begin. Note, you may need to scroll down\n    in the menu to find your model or floor plan.\n</p>\n</div>\n","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":490,"y":320,"wires":[[]]},{"id":"47165ea9.fdf12","type":"ui_template","z":"f6c367c2.63b9b8","group":"e1a5049d.4cee88","name":"Save and Install Message","order":1,"width":"0","height":"0","format":"<div style='height: 220px;'>\n<p>\n    When finished, use the \"Save and Install\" button\n    below to save your changes and re-configure\n    CoachProxyOS.\n</p>\n<p>\n    <br>\n    <b>Important</b>: Your web browser will disconnect momentarily while CoachProxyOS reloads. This re-configuration process will take approximately 30 seconds to complete.\n</p>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":810,"y":1540,"wires":[[]]},{"id":"d031d4bf.52d7b8","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/VER","qos":"0","broker":"c1170463.5c7f8","x":720,"y":2940,"wires":[["ed8f62b5.c7ed48"]]},{"id":"8a00f07e.fdd1f","type":"sqlite","z":"2fdd8124.05e35e","mydb":"b2130e68.3a338","name":"CoachProxy","x":890,"y":160,"wires":[["cdca660e.2a75e8"]]},{"id":"bb8e213c.41e4","type":"inject","z":"2fdd8124.05e35e","name":"At launch","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"onceDelay":"","x":100,"y":80,"wires":[["7544e81a.afed08"]]},{"id":"59ca8f91.7aff9","type":"template","z":"2fdd8124.05e35e","name":"Load settings2","field":"topic","fieldType":"msg","format":"handlebars","syntax":"plain","template":"select * from settings2;","output":"str","x":700,"y":160,"wires":[["8a00f07e.fdd1f"]]},{"id":"cdca660e.2a75e8","type":"function","z":"2fdd8124.05e35e","name":"Store settings2","func":"for (var i = 0; i < (msg.payload).length; i++) {\n    var key = msg.payload[i].key;\n    var value = msg.payload[i].value;\n\n    // If a JSON string is passed in, parse it and save the resulting\n    // object into global context. Otherwise, just save the raw value.\n    if (typeof(value) == 'string' && (value.charAt(0) == '[' || value.charAt(0) == '{')) {\n        global.set('settings2.' + key, JSON.parse(value));\n    } else {\n        global.set('settings2.' + key, value);\n    }\n}\n\n// Returning NULL would terminate the flow, but other\n// nodes want to know when settings have been loaded.\nreturn {};","outputs":1,"noerr":0,"x":1080,"y":160,"wires":[["b8e34e9a.dc367"]]},{"id":"1afee14e.f145af","type":"comment","z":"2fdd8124.05e35e","name":"settings2 database : Link here to save settings or be notified when settings are loaded","info":"","x":340,"y":40,"wires":[]},{"id":"5927abd3.f623e4","type":"function","z":"2fdd8124.05e35e","name":"Save settings2","func":"// Save the provided key and value to the settings2 DB table, and\n// update the settings2 global context.\nvar key = msg.topic;\nvar value = msg.payload;\n\n// If a JSON string is passed in, parse it and save the resulting\n// object into global context. Otherwise, just save the raw value.\nif (typeof(value) == 'string' && (value.charAt(0) == '[' || value.charAt(0) == '{')) {\n    global.set('settings2.' + key, JSON.parse(value));\n} else {\n    global.set('settings2.' + key, value);\n}\n\nvar newmsg = {};\nnewmsg.topic = 'INSERT OR REPLACE INTO settings2 (key, value) VALUES(?, ?)';\nnewmsg.payload = [key, String(value)];\n\nreturn newmsg;","outputs":1,"noerr":0,"x":700,"y":200,"wires":[["8a6a2b57.dbc188"]]},{"id":"8a6a2b57.dbc188","type":"sqlite","z":"2fdd8124.05e35e","mydb":"b2130e68.3a338","name":"CoachProxy","x":890,"y":200,"wires":[["b8e34e9a.dc367"]]},{"id":"b8e34e9a.dc367","type":"link out","z":"2fdd8124.05e35e","name":"Settings2 has been loaded","links":["8a1f3ae4.1ea3a8","cab70e7f.c6c35","72269b85.831204"],"x":1215,"y":200,"wires":[]},{"id":"e357c5ad.eaba18","type":"link in","z":"2fdd8124.05e35e","name":"Save key/value to settings2","links":["3a3cc1a1.4ee1ee","53444718.65a778","bc50fc72.5c00a","2ad4a4a5.c0435c"],"x":535,"y":200,"wires":[["5927abd3.f623e4"]]},{"id":"a71b65f6.8762e8","type":"comment","z":"2fdd8124.05e35e","name":"Send a message to GLOBAL/MESSAGE to display a pop-up alert","info":"","x":270,"y":280,"wires":[]},{"id":"d86399a0.0a9b08","type":"ui_toast","z":"2fdd8124.05e35e","position":"top right","displayTime":"5","highlight":"","outputs":0,"ok":"OK","cancel":"","topic":"","name":"","x":530,"y":320,"wires":[]},{"id":"e1e629e7.af8af8","type":"mqtt in","z":"f6c367c2.63b9b8","name":"","topic":"GLOBAL/SHUTDOWN","qos":"2","broker":"c1170463.5c7f8","x":1400,"y":1500,"wires":[["426d2ff7.9aa5f"]]},{"id":"1ad1aea9.866741","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Mid Zone Heat Pump","group":"dd373808.7ec1d8","order":10,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"midheat","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":800,"y":1140,"wires":[["4f256116.a0922"]]},{"id":"771b1df0.fe0b74","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Rear Zone Heat Pump","group":"dd373808.7ec1d8","order":11,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"rearheat","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":800,"y":1220,"wires":[["4f256116.a0922"]]},{"id":"3d01252.b8a7ada","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Mid Heat Pump","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.midheat = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1120,"wires":[["1ad1aea9.866741"]]},{"id":"c55f7e9a.5b269","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Rear Heat Pump","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.rearheat = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1200,"wires":[["771b1df0.fe0b74"]]},{"id":"176c91be.746e3e","type":"ui_template","z":"f6c367c2.63b9b8","group":"dd373808.7ec1d8","name":"Config HVAC Header","order":7,"width":"6","height":"1","format":"<div style=\"width: 100%; height: 10px; border-bottom: 1px solid black; text-align: center\">\n  <span style=\"background-color: #ffffff; padding: 0 10px;\">\n    2018+ Thermostat Controls\n  </span>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":800,"y":940,"wires":[[]]},{"id":"98b23545.c429e8","type":"function","z":"f6c367c2.63b9b8","name":"Set Second Furnace","func":"// Populate the \"Number of Furnaces\" toggle based on the chosen model.\n\nvar second_furn = ['Phaeton', 'Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '', enabled: true };\n\nif (flow.get('model')) {\n    if (second_furn.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n}\n\nif (flow.get('year') < 2018 && flow.get('model').substr(0,8) != 'VanLeigh') {\n    msg.enabled = false;\n    msg.payload = false;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":1080,"wires":[["a5725878.456328"]]},{"id":"b28430f0.302e8","type":"function","z":"f6c367c2.63b9b8","name":"Set Mid Heat Pump","func":"var mid_hp = ['Phaeton', 'Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '', enabled: true };\n\nif (flow.get('model')) {\n    if (mid_hp.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n}\n\nif (flow.get('year') < 2018 && flow.get('model').substr(0,8) != 'VanLeigh') {\n    msg.enabled = false;\n    msg.payload = false;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":1160,"wires":[["1ad1aea9.866741"]]},{"id":"5dff0e93.907d5","type":"function","z":"f6c367c2.63b9b8","name":"Set Rear Heat Pump","func":"var rear_hp = ['Phaeton', 'Allegro_Bus', 'Zephyr'];\nvar msg = { topic: '', payload: '', enabled: true };\n\nif (flow.get('model')) {\n    if (rear_hp.includes(flow.get('model'))) {\n        msg.payload = true;\n    }\n}\n\nif (flow.get('year') < 2018 && flow.get('model').substr(0,8) != 'VanLeigh') {\n    msg.enabled = false;\n    msg.payload = false;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":1240,"wires":[["771b1df0.fe0b74"]]},{"id":"11b91f3e.6736e1","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_0_night_up/","group":"69274a36.07e384","order":22,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 night up 8","payloadType":"str","topic":"","x":2970,"y":2760,"wires":[["ed2d6b8.2241b98"]]},{"id":"665184f6.aea51c","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_0_night_down/","group":"69274a36.07e384","order":24,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 night down 8","payloadType":"str","topic":"","x":2980,"y":2800,"wires":[["ed2d6b8.2241b98"]]},{"id":"64a1be66.c9c3a","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_1_day_up/","group":"ca0e7a6e.ef51c8","order":6,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"#fff","icon":"","payload":"0","payloadType":"str","topic":"","x":2970,"y":2900,"wires":[["ed2d6b8.2241b98"]]},{"id":"7f90cb9b.78caa4","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_1_day_down/","group":"ca0e7a6e.ef51c8","order":8,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"#fff","icon":"","payload":"0","payloadType":"str","topic":"","x":2980,"y":2940,"wires":[["ed2d6b8.2241b98"]]},{"id":"458215ab.d8648c","type":"ui_template","z":"5a05b8f3.894b88","group":"ca0e7a6e.ef51c8","name":"Entry /shade_1_label/","order":5,"width":"6","height":"1","format":"<div style=\"height: 14px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 18px; font-size: 16px; text-align: center\">\n<div style=\"float:left;\"><i class=\"fa fa-fw fa-sun-o\" style=\"margin-left:44px;\"></i></div>\n<span>Entry</span>\n<div style=\"float:right;\"><i class=\"fa fa-fw fa-moon-o\" style=\"margin-right:44px;\"></i></div>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2960,"y":2860,"wires":[[]]},{"id":"1dc61b95.8a01a4","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_1_night_up/","group":"ca0e7a6e.ef51c8","order":7,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 night up 4","payloadType":"str","topic":"","x":2970,"y":2980,"wires":[["ed2d6b8.2241b98"]]},{"id":"19a00170.49670f","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_1_night_down/","group":"ca0e7a6e.ef51c8","order":9,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 night down 4","payloadType":"str","topic":"","x":2980,"y":3020,"wires":[["ed2d6b8.2241b98"]]},{"id":"1fdb6d02.6118e3","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_2_day_up/","group":"69274a36.07e384","order":6,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 day up 3","payloadType":"str","topic":"","x":2970,"y":3120,"wires":[["ed2d6b8.2241b98"]]},{"id":"7efb144c.b6e6fc","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_2_day_down/","group":"69274a36.07e384","order":8,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 day down 3","payloadType":"str","topic":"","x":2980,"y":3160,"wires":[["ed2d6b8.2241b98"]]},{"id":"db1bc108.1579","type":"ui_template","z":"5a05b8f3.894b88","group":"69274a36.07e384","name":"D/S /shade_2_label/","order":5,"width":"6","height":"1","format":"<div style=\"height: 14px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 18px; font-size: 16px; text-align: center\">\n<div style=\"float:left;\"><i class=\"fa fa-fw fa-sun-o\" style=\"margin-left:44px;\"></i></div>\n<span>D/S</span>\n<div style=\"float:right;\"><i class=\"fa fa-fw fa-moon-o\" style=\"margin-right:44px;\"></i></div>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2960,"y":3080,"wires":[[]]},{"id":"a3e47930.d8e2e8","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_2_night_up/","group":"69274a36.07e384","order":7,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 night up 3","payloadType":"str","topic":"","x":2970,"y":3200,"wires":[["ed2d6b8.2241b98"]]},{"id":"3f14091e.7894e6","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_2_night_down/","group":"69274a36.07e384","order":9,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 night down 3","payloadType":"str","topic":"","x":2980,"y":3240,"wires":[["ed2d6b8.2241b98"]]},{"id":"1d0dfc72.24e1f4","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_3_day_up/","group":"7524ce0d.45bda","order":6,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 day up 3 6 7 8","payloadType":"str","topic":"","x":2970,"y":3340,"wires":[["ed2d6b8.2241b98"]]},{"id":"ba46780a.d9ff08","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_3_day_down/","group":"7524ce0d.45bda","order":8,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 day down 3 6 7 8","payloadType":"str","topic":"","x":2980,"y":3380,"wires":[["ed2d6b8.2241b98"]]},{"id":"492b066c.1ade98","type":"ui_template","z":"5a05b8f3.894b88","group":"7524ce0d.45bda","name":"All Shades /shade_3_label/","order":5,"width":"6","height":"1","format":"<div style=\"height: 14px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 18px; font-size: 16px; text-align: center\">\n<div style=\"float:left;\"><i class=\"fa fa-fw fa-sun-o\" style=\"margin-left:44px;\"></i></div>\n<span>All Shades</span>\n<div style=\"float:right;\"><i class=\"fa fa-fw fa-moon-o\" style=\"margin-right:44px;\"></i></div>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2960,"y":3300,"wires":[[]]},{"id":"d0d4e700.5cbaa8","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_3_night_up/","group":"7524ce0d.45bda","order":7,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 night up 3 6 7 8","payloadType":"str","topic":"","x":2970,"y":3420,"wires":[["ed2d6b8.2241b98"]]},{"id":"f6e2025a.e549d","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_3_night_down/","group":"7524ce0d.45bda","order":9,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 night down 3 6 7 8","payloadType":"str","topic":"","x":2980,"y":3460,"wires":[["ed2d6b8.2241b98"]]},{"id":"ea4adb34.135c18","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_4_day_up/","group":"69274a36.07e384","order":16,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 day up 7","payloadType":"str","topic":"","x":2970,"y":3560,"wires":[["ed2d6b8.2241b98"]]},{"id":"c12f898c.6742e8","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_4_day_down/","group":"69274a36.07e384","order":18,"width":"3","height":"1","passthru":false,"label":"","color":"#eeeeee","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 day down 7","payloadType":"str","topic":"","x":2980,"y":3600,"wires":[["ed2d6b8.2241b98"]]},{"id":"c996678.96ec598","type":"ui_template","z":"5a05b8f3.894b88","group":"69274a36.07e384","name":"P/S Front /shade_4_label/","order":15,"width":"6","height":"1","format":"<div style=\"height: 14px;\">&nbsp;</div>\n<div style=\"width: 100%; height: 18px; font-size: 16px; text-align: center\">\n<span>P/S Front</span>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2960,"y":3520,"wires":[[]]},{"id":"ab7796fa.21e9d8","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_4_night_up/","group":"69274a36.07e384","order":17,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-up fa-3x","payload":"2017 night up 7","payloadType":"str","topic":"","x":2970,"y":3640,"wires":[["ed2d6b8.2241b98"]]},{"id":"1efcf391.3fadcc","type":"ui_button","z":"5a05b8f3.894b88","name":"/shade_4_night_down/","group":"69274a36.07e384","order":19,"width":"3","height":"1","passthru":false,"label":"","color":"#333333","bgcolor":"","icon":"fa-caret-down fa-3x","payload":"2017 night down 7","payloadType":"str","topic":"","x":2980,"y":3680,"wires":[["ed2d6b8.2241b98"]]},{"id":"5fcf3d0f.0436a4","type":"comment","z":"5a05b8f3.894b88","name":"Awnings","info":"","x":4020,"y":2600,"wires":[]},{"id":"bb656f06.c9eb4","type":"delay","z":"f6c367c2.63b9b8","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":420,"wires":[["b33f57fb.ddb3c8"]]},{"id":"ec2c7c9d.42b27","type":"ui_switch","z":"f6c367c2.63b9b8","name":"","label":"Power Smart Bed","group":"dd373808.7ec1d8","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"powerbed","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":790,"y":880,"wires":[["4f256116.a0922"]]},{"id":"d6e99aed.9f4498","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Power Bed","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.powerbed = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":880,"wires":[["ec2c7c9d.42b27"]]},{"id":"34a060d9.0980a","type":"trigger","z":"5a05b8f3.894b88","op1":"true","op2":"false","op1type":"bool","op2type":"bool","duration":"61","extend":true,"units":"s","reset":"false","bytopic":"all","name":"","x":3810,"y":2700,"wires":[["6c6f024f.b3a9fc"]]},{"id":"6c6f024f.b3a9fc","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3770,"y":2760,"wires":[[]]},{"id":"dd652a32.becd48","type":"inject","z":"5a05b8f3.894b88","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":3570,"y":2700,"wires":[["6c6f024f.b3a9fc"]]},{"id":"dee85019.a5891","type":"link out","z":"5a05b8f3.894b88","name":"Awning button pressed","links":["4503c4f.4c6fb3c"],"x":4275,"y":2800,"wires":[]},{"id":"4503c4f.4c6fb3c","type":"link in","z":"5a05b8f3.894b88","name":"Reset awning timer","links":["dee85019.a5891"],"x":3675,"y":2700,"wires":[["34a060d9.0980a","23dc5b1a.c8a5dc"]]},{"id":"282a6d56.cf1e62","type":"ui_text","z":"2fdd8124.05e35e","group":"a027aa68.277858","order":3,"width":0,"height":0,"name":"Feedback Text","label":"","format":"{{msg.payload}}","layout":"row-center","x":720,"y":3500,"wires":[]},{"id":"85eb19db.becd18","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/SHUTDOWN","qos":"2","broker":"c1170463.5c7f8","x":460,"y":3500,"wires":[["282a6d56.cf1e62"]]},{"id":"165202ff.dbfd0d","type":"ui_template","z":"5a05b8f3.894b88","group":"2e0a52f8.6acbee","name":"Custom CSS","order":0,"width":0,"height":0,"format":"<link rel=\"stylesheet\" href=\"css/font-awesome-animation.min.css\">\n<style type=\"text/css\">button { touch-action: manipulation; }</style>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"global","x":670,"y":40,"wires":[[]]},{"id":"421b1a3.131bfe4","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":160,"wires":[["dac109f5.ce7508","9ebfbff9.a53c5"]]},{"id":"702c340b.b0efcc","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/25","qos":"0","datatype":"auto","broker":"c1170463.5c7f8","x":160,"y":160,"wires":[["421b1a3.131bfe4"]]},{"id":"7544e81a.afed08","type":"change","z":"2fdd8124.05e35e","name":"Light List","rules":[{"t":"set","p":"lights","pt":"msg","to":"[1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,19,21,22,28,95,96]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":80,"wires":[["8a3a4af9.460768"]]},{"id":"54d38100.5eccf","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":240,"wires":[["64729712.b36e68"]]},{"id":"2f4d0c99.e23bf4","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/2","qos":"0","broker":"c1170463.5c7f8","x":150,"y":240,"wires":[["54d38100.5eccf"]]},{"id":"9b24d1f5.16c55","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":320,"wires":[["6c5178e1.6a4be8"]]},{"id":"6e66b523.d3213c","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":400,"wires":[["409db98b.807d48"]]},{"id":"48ba5fa7.733b1","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":560,"wires":[["81a2736.51b639"]]},{"id":"704f4d41.50fa54","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":640,"wires":[["5badb2ed.c9b0ec"]]},{"id":"10cb22c8.dbffad","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":720,"wires":[["ede65af9.7b44e8"]]},{"id":"35623104.63cf5e","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":800,"wires":[["55a2f976.8a3eb8"]]},{"id":"9a7441fa.80371","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":880,"wires":[["38e39d9a.7e7722"]]},{"id":"9b4ab7bf.f2a028","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":960,"wires":[["c214cdb9.9725c"]]},{"id":"b38620e7.ca078","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1040,"wires":[["370c14b2.24256c"]]},{"id":"64729712.b36e68","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":240,"wires":[["b7651bea.41be5"],["bde18df6.2960f"]],"outputLabels":["on/off value","brightness value"]},{"id":"6c5178e1.6a4be8","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":320,"wires":[["f766527c.b54708"],["32fb20fc.33fb1"]],"outputLabels":["on/off value","brightness value"]},{"id":"409db98b.807d48","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":400,"wires":[["77238d9f.d85fac"],["b5f5aa62.b1b8c"]],"outputLabels":["on/off value","brightness value"]},{"id":"81a2736.51b639","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":560,"wires":[["443d87c4.3023d"],["9ff3b254.0a9e"]],"outputLabels":["on/off value","brightness value"]},{"id":"5badb2ed.c9b0ec","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":640,"wires":[["de5083f5.8f342"],["255e8300.e6f6dc"]],"outputLabels":["on/off value","brightness value"]},{"id":"ede65af9.7b44e8","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":720,"wires":[["e291aabb.d74588"],["d573ae50.c4dc38"]],"outputLabels":["on/off value","brightness value"]},{"id":"55a2f976.8a3eb8","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":800,"wires":[["93ad9c5a.823bf8"],["a6532b96.f6876"]],"outputLabels":["on/off value","brightness value"]},{"id":"38e39d9a.7e7722","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":880,"wires":[["f1ceb03a.ba774"],["285ed135.2d577e"]],"outputLabels":["on/off value","brightness value"]},{"id":"c214cdb9.9725c","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":960,"wires":[["21309d67.8efe4a"],["36b5f55f.b2f8d2"]],"outputLabels":["on/off value","brightness value"]},{"id":"370c14b2.24256c","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1040,"wires":[["6462abc1.33600c"],["27927976.cdaa96"]],"outputLabels":["on/off value","brightness value"]},{"id":"2b9cec.6cfee314","type":"file function","z":"5a05b8f3.894b88","name":"command_dc_dimmer.js","filename":".node-red/js/command_dc_dimmer.js","reloadfile":false,"outputs":1,"x":1170,"y":1560,"wires":[["4f494263.b11554"]]},{"id":"2d1644ca.88801c","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1120,"wires":[["20d447bc.888078","2bafa329.60859c"]]},{"id":"20d447bc.888078","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1120,"wires":[["d6b864ad.90e7"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"954fca3c.713728","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1160,"wires":[["661323d5.b8dbec"]]},{"id":"661323d5.b8dbec","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1160,"wires":[["84390b0f.966a78"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"691546ca.f35808","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1200,"wires":[["92ee50e8.fe54"]]},{"id":"92ee50e8.fe54","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1200,"wires":[["1181d0df.43e3df"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"a1bb8cfa.065bd","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1240,"wires":[["721de4ce.5398ac"]]},{"id":"721de4ce.5398ac","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1240,"wires":[["e60ee355.41d3e"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"6fe76ebc.77282","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1280,"wires":[["295c5766.4c4a78"]]},{"id":"295c5766.4c4a78","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1280,"wires":[["93be5b8b.d5c55"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"727a6203.75b2ac","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1360,"wires":[["f354009e.57075"]]},{"id":"f354009e.57075","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1360,"wires":[["3d478679.218eb2"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"ab2b6263.ee1b","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1440,"wires":[["9ea31617.2401e8"]]},{"id":"9ea31617.2401e8","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1440,"wires":[["e83821db.4db18"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"517f7e0e.4cf6c","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1720,"wires":[["c4b6c05e.16cae"]]},{"id":"c4b6c05e.16cae","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1720,"wires":[["8b4bfcc0.e943c8"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"8f0a15f8.272588","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":270,"y":2480,"wires":[["6b2a8e3c.7dae6"]]},{"id":"3632b964.74aed6","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":270,"y":2520,"wires":[["3efa950e.1e555a"]]},{"id":"1bd75c83.f0b843","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":270,"y":2560,"wires":[["6f90232b.f3f15c"]]},{"id":"5d128818.9a8018","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":270,"y":2600,"wires":[["d7c44de8.ccfb5"]]},{"id":"615c2c3f.a6b5b4","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1400,"wires":[["94b1f43e.8fc288"]]},{"id":"8adf11db.a3c73","type":"mqtt in","z":"5a05b8f3.894b88","name":"/mid-fan-mqtt/","topic":"RVC/DC_DIMMER_STATUS_3/29","qos":"0","broker":"c1170463.5c7f8","x":2780,"y":1540,"wires":[["a65c9a11.a515a8"]]},{"id":"a1e1af55.5db38","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1540,"wires":[["befd7fa1.f282c8"]]},{"id":"64888a73.0a4434","type":"file function","z":"5a05b8f3.894b88","name":"decode_fan.js","filename":".node-red/js/decode_fan.js","reloadfile":false,"outputs":1,"x":3340,"y":1540,"wires":[["a1e1af55.5db38"]]},{"id":"7025b01e.e5a6b","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1540,"wires":[["64888a73.0a4434"]]},{"id":"a65c9a11.a515a8","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1540,"wires":[["7025b01e.e5a6b"]]},{"id":"6601adf8.362754","type":"mqtt in","z":"5a05b8f3.894b88","name":"/rear-fan-mqtt/","topic":"RVC/DC_DIMMER_STATUS_3/32","qos":"0","broker":"c1170463.5c7f8","x":2780,"y":1680,"wires":[["50120715.ff8c38"]]},{"id":"399063dd.8206ac","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":3510,"y":1680,"wires":[["180fe239.89b066"]]},{"id":"e32eec2c.20163","type":"file function","z":"5a05b8f3.894b88","name":"decode_fan.js","filename":".node-red/js/decode_fan.js","reloadfile":false,"outputs":1,"x":3340,"y":1680,"wires":[["399063dd.8206ac"]]},{"id":"a5119a0d.decb68","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"instance","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1680,"wires":[["e32eec2c.20163"]]},{"id":"50120715.ff8c38","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1680,"wires":[["a5119a0d.decb68"]]},{"id":"8c0ff247.bec05","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2930,"y":1880,"wires":[["c43b4452.61cbd8"]]},{"id":"67653654.1bbe68","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2930,"y":1920,"wires":[["8667ee3f.a12b9"]]},{"id":"d58309bb.20a988","type":"comment","z":"5a05b8f3.894b88","name":"Advanced power display (2018+)","info":"","x":210,"y":2880,"wires":[]},{"id":"99e7d694.1fd918","type":"comment","z":"5a05b8f3.894b88","name":"Basic power display (2015-2017)","info":"","x":210,"y":2720,"wires":[]},{"id":"7fcb9ba8.efd314","type":"comment","z":"5a05b8f3.894b88","name":"120V ATS Power Display (2018+)","info":"","x":210,"y":3260,"wires":[]},{"id":"e9c1dc49.0f07d","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 1 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"1. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"1","x":1800,"y":2140,"wires":[["eaa9316c.0870a"]]},{"id":"81d22ff8.f5f1d","type":"ui_dropdown","z":"5a05b8f3.894b88","name":"Choose Preset","label":"","place":"Preset Number:","group":"7fba8042.84c76","order":2,"width":"6","height":"1","passthru":false,"options":[{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":"7","type":"str"},{"label":"","value":"8","type":"str"},{"label":"","value":"9","type":"str"},{"label":"","value":"10","type":"str"}],"payload":"","topic":"item","x":1780,"y":1720,"wires":[["a54ef26f.7a001","f1429565.089148"]]},{"id":"280cfbf0.e0def4","type":"ui_text_input","z":"5a05b8f3.894b88","name":"","label":"Preset name:","group":"7fba8042.84c76","order":3,"width":"6","height":"1","passthru":true,"mode":"text","delay":300,"topic":"name","x":1770,"y":1760,"wires":[["a54ef26f.7a001"]]},{"id":"f243a747.478f28","type":"ui_switch","z":"5a05b8f3.894b88","name":"Lights","label":"Lights","group":"7fba8042.84c76","order":5,"width":"3","height":"1","passthru":true,"decouple":"false","topic":"opt_lights","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1750,"y":1840,"wires":[["a54ef26f.7a001"]]},{"id":"c0ccb1c5.dccce","type":"ui_text","z":"5a05b8f3.894b88","group":"7fba8042.84c76","order":4,"width":0,"height":0,"name":"","label":"Choose items to save:","format":"{{msg.payload}}","layout":"row-spread","x":1800,"y":1800,"wires":[]},{"id":"cc71e3f2.87bfa","type":"ui_switch","z":"5a05b8f3.894b88","name":"Vents / Fans","label":"Vents/Fans","group":"7fba8042.84c76","order":7,"width":"3","height":"1","passthru":true,"decouple":"false","topic":"opt_vents","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1770,"y":1960,"wires":[["a54ef26f.7a001"]]},{"id":"ae9a1735.7bdf08","type":"ui_button","z":"5a05b8f3.894b88","name":"","group":"7fba8042.84c76","order":10,"width":"5","height":"1","passthru":false,"label":"Save Preset","color":"","bgcolor":"","icon":"fa-check","payload":"save","payloadType":"str","topic":"","x":1770,"y":2000,"wires":[["a38ff219.cd636"]]},{"id":"b343a418.1beda8","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 2 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"2. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"2","x":1800,"y":2180,"wires":[["eaa9316c.0870a"]]},{"id":"a54ef26f.7a001","type":"function","z":"5a05b8f3.894b88","name":"Store form values","func":"global.set('form.preset.' + msg.topic, msg.payload);\n\nreturn null;","outputs":1,"noerr":0,"x":2050,"y":1820,"wires":[[]]},{"id":"8338a83a.45f028","type":"ui_ui_control","z":"5a05b8f3.894b88","name":"Tab Selected","x":1310,"y":1820,"wires":[["cbb8ba60.4f75b8","b3115c5a.ad76","e0c017f1.80eeb8","5f74d25.681df2c"]]},{"id":"cbb8ba60.4f75b8","type":"change","z":"5a05b8f3.894b88","name":"payload: true","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1550,"y":1860,"wires":[["f243a747.478f28"]]},{"id":"b3115c5a.ad76","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1720,"wires":[["81d22ff8.f5f1d"]]},{"id":"e0c017f1.80eeb8","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1760,"wires":[["280cfbf0.e0def4"]]},{"id":"189a4b69.4aff25","type":"sqlite","z":"5a05b8f3.894b88","mydb":"b9bfcd9c.3c935","name":"","x":2260,"y":2000,"wires":[[]]},{"id":"a29e5196.33994","type":"link in","z":"5a05b8f3.894b88","name":"update presets UI","links":["5947b91c.315298","e93057bd.d997f8"],"x":1415,"y":2320,"wires":[["deb0a82a.d5fc18","369e75b5.5d74fa","b9af935c.f49a1","bcaa2272.bedbc","2cfe9b42.aaaf44","9d208865.309e08","a0768f15.a773e","2b0cc01a.9bc6f","d01a90c5.7bf5","62c870cf.819f4"]]},{"id":"deb0a82a.d5fc18","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[3].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2220,"wires":[["4d09f665.0a9b98"]]},{"id":"4d09f665.0a9b98","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 3 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"3. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"3","x":1800,"y":2220,"wires":[["eaa9316c.0870a"]]},{"id":"369e75b5.5d74fa","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[2].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2180,"wires":[["b343a418.1beda8"]]},{"id":"b9af935c.f49a1","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[1].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2140,"wires":[["e9c1dc49.0f07d"]]},{"id":"bcaa2272.bedbc","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[4].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2260,"wires":[["a4192dc5.a6b4d"]]},{"id":"a4192dc5.a6b4d","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 4 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"4. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"4","x":1800,"y":2260,"wires":[["eaa9316c.0870a"]]},{"id":"5947b91c.315298","type":"link out","z":"5a05b8f3.894b88","name":"Preset updated","links":["a29e5196.33994"],"x":2135,"y":2040,"wires":[]},{"id":"6155164b.8f43c8","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/dc_dimmer.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"dc_dimmer.pl","x":2260,"y":2220,"wires":[[],[],[]]},{"id":"2cfe9b42.aaaf44","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[5].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2300,"wires":[["d4c54815.53c5f8"]]},{"id":"d4c54815.53c5f8","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 5 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"5. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"5","x":1800,"y":2300,"wires":[["eaa9316c.0870a"]]},{"id":"9d208865.309e08","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[6].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2340,"wires":[["bf39e45c.21bf28"]]},{"id":"bf39e45c.21bf28","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 6 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"6. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"6","x":1800,"y":2340,"wires":[["eaa9316c.0870a"]]},{"id":"7ea58ead.117bc","type":"ui_template","z":"5a05b8f3.894b88","group":"7fba8042.84c76","name":"Presets Instructions","order":1,"width":"6","height":"4","format":"<div layout=\"column\" layout-align=\"space-between\">\n<p>\nSelect a preset number, enter a name, choose which devices\nto remember, and select \"Save Preset\".\n</p>\n<p>Later, use the numbered preset buttons to restore your\nlights and/or thermostats to the saved values.\n</p>\n<p>\nNote: Thermostat preset support (if available in your coach) is\ncurrently experimental.\n</p>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":1800,"y":1680,"wires":[[]]},{"id":"f1429565.089148","type":"function","z":"5a05b8f3.894b88","name":"Update preset name field","func":"var preset = global.get('presets')[msg.payload];\nvar name = preset ? preset.name : '';\nreturn { payload: name };","outputs":1,"noerr":0,"x":2030,"y":1720,"wires":[["280cfbf0.e0def4"]]},{"id":"5f74d25.681df2c","type":"change","z":"5a05b8f3.894b88","name":"enabled: false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1940,"wires":[["cc71e3f2.87bfa"]]},{"id":"1f37898c.ab8036","type":"template","z":"2fdd8124.05e35e","name":"Load presets","field":"topic","fieldType":"msg","format":"handlebars","syntax":"plain","template":"select * from presets;","output":"str","x":690,"y":80,"wires":[["b7dc14dd.f21c28"]]},{"id":"b7dc14dd.f21c28","type":"sqlite","z":"2fdd8124.05e35e","mydb":"b2130e68.3a338","name":"CoachProxy","x":890,"y":80,"wires":[["7b893f4b.6cfd4"]]},{"id":"7b893f4b.6cfd4","type":"function","z":"2fdd8124.05e35e","name":"Store presets","func":"var presets = [];\nfor (let i = 1; i <= 10; i++) {\n    presets[i] = { name: '' };\n}\n\nfor (let i = 0; i < (msg.payload).length; i++) {\n    let number = msg.payload[i].number;\n    let data = JSON.parse(msg.payload[i].data);\n    presets[number] = data;\n}\n\nglobal.set('presets', presets);\n\n// Returning NULL would terminate the flow, but other\n// nodes want to know when settings have been loaded.\nreturn {};","outputs":1,"noerr":0,"x":1080,"y":80,"wires":[["e93057bd.d997f8"]]},{"id":"e93057bd.d997f8","type":"link out","z":"2fdd8124.05e35e","name":"presets have been loaded","links":["56509485.b3fb0c","a29e5196.33994"],"x":1215,"y":80,"wires":[]},{"id":"eba46037.bb4ae","type":"ui_button","z":"5a05b8f3.894b88","name":"Delete Preset","group":"7fba8042.84c76","order":11,"width":"1","height":"1","passthru":false,"label":"","color":"","bgcolor":"#8D0000","icon":"fa-trash","payload":"delete","payloadType":"str","topic":"","x":1780,"y":2040,"wires":[["3e46d0a4.69eb"]]},{"id":"fd50868f.d25368","type":"change","z":"5a05b8f3.894b88","name":"Payload 210+cmd","rules":[{"t":"set","p":"payload","pt":"msg","to":"'210 ' & (payload = 'on' ? '2' : '3')","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1110,"y":2560,"wires":[[]]},{"id":"a16da173.42902","type":"template","z":"5a05b8f3.894b88","name":"fan_template /ventfan-mid/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1540,"wires":[["6ffd198e.82cac8"]]},{"id":"9827a588.93a228","type":"template","z":"5a05b8f3.894b88","name":"fan_template /ventfan-galley/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1400,"wires":[["6ffd198e.82cac8"]]},{"id":"5a98a135.be91b","type":"template","z":"5a05b8f3.894b88","name":"fan_template /ventfan-rear/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1680,"wires":[["6ffd198e.82cac8"]]},{"id":"377a6668.f0166a","type":"template","z":"5a05b8f3.894b88","name":"lid_template /ventfan-galley/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1440,"wires":[["f0bc266a.d81d4"]]},{"id":"cdf137d9.e46f98","type":"template","z":"5a05b8f3.894b88","name":"lid_template /ventfan-mid/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1580,"wires":[["f0bc266a.d81d4"]]},{"id":"393df8b6.9f3828","type":"template","z":"5a05b8f3.894b88","name":"lid_template /ventfan-rear/+pred/","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{payload}} {{topic}}","x":4000,"y":1720,"wires":[["f0bc266a.d81d4"]]},{"id":"5c274695.94a878","type":"mqtt in","z":"5a05b8f3.894b88","name":"/tankheat_in/","topic":"RVC/DC_DIMMER_STATUS_3/0","qos":"0","broker":"c1170463.5c7f8","x":110,"y":2640,"wires":[["4067804b.7e994"]]},{"id":"4067804b.7e994","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":270,"y":2640,"wires":[["2de5d326.62f36c"]]},{"id":"6e343550.d4c04c","type":"ui_template","z":"2fdd8124.05e35e","group":"a027aa68.277858","name":"Voice Discovery Notes","order":1,"width":"6","height":"3","format":"<div style='margin-bottom: 1em;'>\nIf Alexa Discovery is not finding any devices, you can\nrestart the CoachProxyOS voice software with the button below,\nthen immediately try discovery again via Alexa.\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":460,"y":3560,"wires":[[]]},{"id":"46cd9439.7db8dc","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"a027aa68.277858","order":2,"width":"6","height":"1","passthru":false,"label":"Restart Voice Integration","color":"","bgcolor":"","icon":"fa-refresh","payload":"Restarting Voice Software...","payloadType":"str","topic":"","x":470,"y":3600,"wires":[["4e666121.1cd37","7ae2fd18.387b74","282a6d56.cf1e62"]]},{"id":"4e666121.1cd37","type":"exec","z":"2fdd8124.05e35e","command":"/coachproxy/ha-bridge/re-init","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"","x":770,"y":3600,"wires":[[],[],[]]},{"id":"7ae2fd18.387b74","type":"delay","z":"2fdd8124.05e35e","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":700,"y":3560,"wires":[["93e5bf34.e3f6a"]]},{"id":"93e5bf34.e3f6a","type":"change","z":"2fdd8124.05e35e","name":"blank","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":3560,"wires":[["282a6d56.cf1e62"]]},{"id":"ed486cdc.34cda","type":"file function","z":"5a05b8f3.894b88","name":"thermostat_ambient_decode","filename":".node-red/js/thermostat_ambient_decode.js","reloadfile":false,"outputs":"3","x":3100,"y":1220,"wires":[["9943085f.65a718"],["3d15c9a4.2aff16"],["e5fe007b.15c75"]]},{"id":"343b0afd.eb6c16","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"obj","pretty":false,"x":2870,"y":1220,"wires":[["ed486cdc.34cda"]]},{"id":"9943085f.65a718","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"0.4","start":"","inout":"out","x":3330,"y":1180,"wires":[[]]},{"id":"3d15c9a4.2aff16","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"0.4","start":"","inout":"out","x":3330,"y":1220,"wires":[[]]},{"id":"e5fe007b.15c75","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"0.4","start":"","inout":"out","x":3330,"y":1260,"wires":[[]]},{"id":"20bd3918.2680b6","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/THERMOSTAT_AMBIENT_STATUS/#","qos":"0","broker":"c1170463.5c7f8","x":2600,"y":1220,"wires":[["343b0afd.eb6c16"]]},{"id":"49eafa.00923508","type":"switch","z":"5a05b8f3.894b88","name":"Lock Type","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"--","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1690,"y":980,"wires":[["57101b18.624394"],["84e70031.58d4f"]],"outputLabels":["2019+","2015-2018"]},{"id":"57101b18.624394","type":"exec","z":"5a05b8f3.894b88","command":"/coachproxy/rv-c/dc_dimmer_pair.pl ","addpay":true,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"dc_dimmer_pair.pl /locks/+pred/","x":1930,"y":960,"wires":[[],[],[]]},{"id":"84c29343.d700a","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"NETWORK/#","qos":"0","broker":"c1170463.5c7f8","x":110,"y":420,"wires":[["ded540a8.bef63"]]},{"id":"19cb1b48.a85c05","type":"ui_template","z":"2fdd8124.05e35e","group":"cd05e210.dac658","name":"WiFi Network Info","order":1,"width":"6","height":"6","format":"<div layout=\"column\" layout-align=\"space-between\">\n    <div>{{msg.message}}</div>&nbsp;\n    <div>&nbsp;</div>\n    <div style=\"text-align: center; font-weight: bold\">Your WiFi Network</div>&nbsp;\n    <div layout=\"row\" layout-align=\"space-between\"><span>Network:</span>{{msg.data.WPA.SSID}}</div>&nbsp;\n    <div layout=\"row\" layout-align=\"space-between\"><span>IP Address:</span><a href='http://{{msg.data.WPA.IP}}'>{{msg.data.WPA.IP}}</a></div>&nbsp;\n    <div layout=\"row\" layout-align=\"space-between\"><span>HW Address:</span>{{msg.data.WPA.MAC}}</div>&nbsp;\n    <div layout=\"row\" layout-align=\"space-between\"><span>Connection Status:</span>{{msg.data.WPA.STATE}}</div>&nbsp;\n    <div layout=\"row\" layout-align=\"space-between\"><span>Connection Quality:</span>{{msg.data.WPA.QUALITY}}%</div>&nbsp;\n    <p>&nbsp;</p>\n</div>\n","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":890,"y":420,"wires":[[]]},{"id":"326735d2.c640ba","type":"rbe","z":"2fdd8124.05e35e","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":510,"y":420,"wires":[["998a248b.358218"]]},{"id":"ded540a8.bef63","type":"file function","z":"2fdd8124.05e35e","name":"network_info.js","filename":".node-red/js/network_info.js","reloadfile":false,"outputs":1,"x":320,"y":420,"wires":[["326735d2.c640ba"]]},{"id":"a38ff219.cd636","type":"file function","z":"5a05b8f3.894b88","name":"preset_save.js","filename":".node-red/js/preset_save.js","reloadfile":false,"outputs":2,"x":1980,"y":2000,"wires":[["189a4b69.4aff25"],["5947b91c.315298"]]},{"id":"8a3a4af9.460768","type":"file function","z":"2fdd8124.05e35e","name":"initialize_global_context.js","filename":".node-red/js/initialize_global_context.js","reloadfile":true,"outputs":1,"x":470,"y":80,"wires":[["1f37898c.ab8036","59ca8f91.7aff9","6cb7aeff.ab5aa"]]},{"id":"eaa9316c.0870a","type":"file function","z":"5a05b8f3.894b88","name":"preset_restore.js","filename":".node-red/js/preset_restore.js","reloadfile":false,"outputs":4,"x":2040,"y":2320,"wires":[["6155164b.8f43c8"],[],[],[]],"outputLabels":["lights","tstats","floors","vents"]},{"id":"a0768f15.a773e","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[7].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2380,"wires":[["87993505.257e28"]]},{"id":"87993505.257e28","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 7 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"7. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"7","x":1800,"y":2380,"wires":[["eaa9316c.0870a"]]},{"id":"2b0cc01a.9bc6f","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[8].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2420,"wires":[["99b00e6a.b1aa5"]]},{"id":"99b00e6a.b1aa5","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 8 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"8. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"8","x":1800,"y":2420,"wires":[["eaa9316c.0870a"]]},{"id":"d01a90c5.7bf5","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[9].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2460,"wires":[["d5a0d138.3f361"]]},{"id":"d5a0d138.3f361","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 9 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"9. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"9","x":1800,"y":2460,"wires":[["eaa9316c.0870a"]]},{"id":"62c870cf.819f4","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presets[10].name","tot":"global"},{"t":"set","p":"enabled","pt":"msg","to":"payload != ''","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":2500,"wires":[["87b7fa62.364878"]]},{"id":"87b7fa62.364878","type":"ui_button","z":"5a05b8f3.894b88","name":"Preset 10 Button","group":"a47948b7.53b7b8","order":2,"width":"0","height":"0","passthru":false,"label":"10. {{msg.payload}}","color":"","bgcolor":"","icon":"","payload":"activate","payloadType":"str","topic":"10","x":1810,"y":2500,"wires":[["eaa9316c.0870a"]]},{"id":"9fc555ef.65b448","type":"json","z":"2fdd8124.05e35e","name":"","property":"payload","action":"","pretty":false,"x":790,"y":3440,"wires":[["2408673.a578d98"]]},{"id":"a4d6128e.0b4f6","type":"file in","z":"2fdd8124.05e35e","name":"ha-bridge/device.db","filename":"/coachproxy/ha-bridge/device.db","format":"utf8","chunk":false,"sendError":false,"x":580,"y":3440,"wires":[["9fc555ef.65b448"]]},{"id":"2408673.a578d98","type":"function","z":"2fdd8124.05e35e","name":"Create Voice Command List","func":"var template = '<div layout=\"column\" layout-align=\"space-between\">';\ntemplate += '<p>Voice Integration supports ' + (msg.payload).length + ' voice command devices for your coach, listed below.</p>\\n';\ntemplate += '<p>Each device responds to \"turn on\" and \"turn off\" voice commands. Devices listed with a plus sign (<b>+</b>) in front of them also respond to \"dim\" commands.</p>\\n';\ntemplate += '<p>Some example commands include: \"Alexa, turn on task light\", or \"Alexa, dim main ceiling light to 50 percent\".</p>\\n';\ntemplate += '<hr>\\n';\n\ntemplate += '<p>';\nfor (let i = 0; i < (msg.payload).length; i++) {\n    let name = msg.payload[i].name.trim();\n    let dim = msg.payload[i].dimUrl;\n    let bullet = dim ? '+' : '-';\n    template += bullet + ' ' + name + '<br>\\n';\n}\ntemplate += '</p>';\n\ntemplate += '</div>';\nmsg.template = template;\n\nreturn msg;","outputs":1,"noerr":0,"x":1020,"y":3440,"wires":[["82837448.a8e478"]]},{"id":"82837448.a8e478","type":"ui_template","z":"2fdd8124.05e35e","group":"7dcb24f9.ce47cc","name":"Voice Command List","order":1,"width":"6","height":"25","format":"","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1300,"y":3440,"wires":[[]]},{"id":"d41e8eef.726dd","type":"inject","z":"2fdd8124.05e35e","name":"inject at start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":330,"y":3440,"wires":[["a4d6128e.0b4f6"]]},{"id":"30869709.57ea08","type":"comment","z":"2fdd8124.05e35e","name":"Voice Integration Settings","info":"","x":350,"y":3400,"wires":[]},{"id":"f5adb9ac.093858","type":"change","z":"5a05b8f3.894b88","name":"Set Chart Label","rules":[{"t":"set","p":"topic","pt":"msg","to":"$replace(msg.topic, /.*\\//, '')","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":3560,"wires":[["3d0470ed.386b4"]]},{"id":"406f7d8e.c9e964","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/TANK_STATUS/#","qos":"2","broker":"c1170463.5c7f8","x":140,"y":80,"wires":[["cd187e10.f8322"]]},{"id":"cd187e10.f8322","type":"json","z":"477cac19.6a9e64","name":"","property":"payload","action":"","pretty":false,"x":410,"y":80,"wires":[["f5e5995e.fe3888"]]},{"id":"b253067e.9633c8","type":"mqtt out","z":"477cac19.6a9e64","name":"CP/TANK_STATUS/TankName","topic":"","qos":"","retain":"","broker":"c1170463.5c7f8","x":890,"y":80,"wires":[]},{"id":"16624199.59e1ee","type":"comment","z":"477cac19.6a9e64","name":"Determine parking brake and ignition status and republish it","info":"","x":260,"y":160,"wires":[]},{"id":"d04e0e71.972ce","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/CHASSIS_MOBILITY_STATUS","qos":"2","broker":"c1170463.5c7f8","x":180,"y":200,"wires":[["947840a5.14609"]]},{"id":"947840a5.14609","type":"json","z":"477cac19.6a9e64","name":"","property":"payload","action":"","pretty":false,"x":410,"y":200,"wires":[["d4932ecd.c9281"]]},{"id":"3f6d5ecb.388b62","type":"mqtt out","z":"477cac19.6a9e64","name":"CP/IGNITION or CP/PARKBRAKE","topic":"","qos":"","retain":"","broker":"c1170463.5c7f8","x":900,"y":200,"wires":[]},{"id":"660b012f.2bc5b","type":"comment","z":"477cac19.6a9e64","name":"Calculate holding tank percent full and republish it","info":"","x":230,"y":40,"wires":[]},{"id":"eff55b53.b6f288","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/GENERIC_INDICATOR_COMMAND/255","qos":"2","broker":"c1170463.5c7f8","x":1190,"y":80,"wires":[["a2639d33.9e3ff"]]},{"id":"a2639d33.9e3ff","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":1450,"y":80,"wires":[["5da87095.951df"]]},{"id":"a0c0d1db.0ba1e","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.brightness > 0 ? 100 : 0","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1820,"y":60,"wires":[["9ee193c3.f6d9f8"]]},{"id":"90b01324.960d5","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.brightness","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1820,"y":100,"wires":[["4251713d.675418"]]},{"id":"10e80e93.5f0211","type":"template","z":"5a05b8f3.894b88","name":"Add group id","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"126 {{payload}}","output":"str","x":2190,"y":80,"wires":[["f9363c14.d66b"]]},{"id":"db18d704.757568","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1440,"wires":[["db84192e.531118"]]},{"id":"e2626070.a4c46","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1580,"wires":[["9be5525c.44dd3"]]},{"id":"bf38c6b9.0803e8","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":2950,"y":1720,"wires":[["dd42ed8b.551b7"]]},{"id":"8a3a667e.b770d8","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/GENERATOR_STATUS_1","qos":"2","broker":"c1170463.5c7f8","x":160,"y":320,"wires":[["bb3a5438.3970d8"]]},{"id":"bb3a5438.3970d8","type":"json","z":"477cac19.6a9e64","name":"","property":"payload","action":"","pretty":false,"x":410,"y":320,"wires":[["4c155211.73165c"]]},{"id":"f0779982.feef28","type":"mqtt out","z":"477cac19.6a9e64","name":"","topic":"CP/GENERATOR","qos":"","retain":"","broker":"c1170463.5c7f8","x":910,"y":320,"wires":[]},{"id":"45e1761e.135ae8","type":"comment","z":"477cac19.6a9e64","name":"Republish generator status in simple form","info":"","x":200,"y":280,"wires":[]},{"id":"cd976c85.83861","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"type","pt":"msg","to":"generator","tot":"str"},{"t":"set","p":"pkttime","pt":"msg","to":"$substringAfter(payload, ',')","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"$substringBefore(payload, ',')","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":3920,"wires":[["5b0c641c.f195ec"]]},{"id":"2de5d326.62f36c","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"brightness","pt":"msg","to":"payload['operating status (brightness)']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"brightness > 0 ? 'on' : 'off'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2640,"wires":[["d6cf63b1.0211f"]]},{"id":"d7c44de8.ccfb5","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"brightness","pt":"msg","to":"payload['operating status (brightness)']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"brightness > 0 ? 'on' : 'off'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2600,"wires":[["38322680.caf3aa"]]},{"id":"6f90232b.f3f15c","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"brightness","pt":"msg","to":"payload['operating status (brightness)']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"brightness > 0 ? 'on' : 'off'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2560,"wires":[["369132c8.0a300e"]]},{"id":"3efa950e.1e555a","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"brightness","pt":"msg","to":"payload['operating status (brightness)']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"brightness > 0 ? 'on' : 'off'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2520,"wires":[["4ea2babc.bffcf4"]]},{"id":"6b2a8e3c.7dae6","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"brightness","pt":"msg","to":"payload['operating status (brightness)']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"brightness > 0 ? 'on' : 'off'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2480,"wires":[["b363f64.81e8f08"]]},{"id":"5da87095.951df","type":"switch","z":"5a05b8f3.894b88","name":"Pass Group 126","property":"payload.group","propertyType":"msg","rules":[{"t":"eq","v":"01111110","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1620,"y":80,"wires":[["a0c0d1db.0ba1e","90b01324.960d5"]]},{"id":"d4932ecd.c9281","type":"file function","z":"477cac19.6a9e64","name":"decode_chassis_mobility","filename":".node-red/js/decode_chassis_mobility.js","reloadfile":false,"outputs":1,"x":610,"y":200,"wires":[["3f6d5ecb.388b62"]]},{"id":"f5e5995e.fe3888","type":"file function","z":"477cac19.6a9e64","name":"decode_tank","filename":".node-red/js/decode_tank.js","reloadfile":false,"outputs":1,"x":570,"y":80,"wires":[["b253067e.9633c8"]]},{"id":"9d783f83.49571","type":"split","z":"5a05b8f3.894b88","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1020,"y":3660,"wires":[[]]},{"id":"3e46d0a4.69eb","type":"file function","z":"5a05b8f3.894b88","name":"preset_delete.js","filename":".node-red/js/preset_delete.js","reloadfile":false,"outputs":2,"x":1980,"y":2040,"wires":[["189a4b69.4aff25"],["e0c017f1.80eeb8","5947b91c.315298"]]},{"id":"ea5d3dfc.eb98","type":"http request","z":"2fdd8124.05e35e","name":"ngrok tunnel info","method":"GET","ret":"txt","url":"http://localhost:4040/api/tunnels/coachproxy","tls":"","x":690,"y":2380,"wires":[["5040b9f8.e68ee8"]]},{"id":"abd2f48d.eed968","type":"inject","z":"2fdd8124.05e35e","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"1","crontab":"","once":true,"onceDelay":"1","x":490,"y":2380,"wires":[["ea5d3dfc.eb98"]]},{"id":"7897c8d.05a0a38","type":"json","z":"2fdd8124.05e35e","name":"","property":"payload","action":"","pretty":false,"x":1050,"y":2360,"wires":[["87e5b74a.480508"]]},{"id":"5040b9f8.e68ee8","type":"switch","z":"2fdd8124.05e35e","name":"Status Code","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":2380,"wires":[["7897c8d.05a0a38"],["7342ea49.a2c6a4"]]},{"id":"7342ea49.a2c6a4","type":"change","z":"2fdd8124.05e35e","name":"Offline","rules":[{"t":"set","p":"payload","pt":"msg","to":"Offline","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1190,"y":2400,"wires":[["861fe173.d8f1d"]]},{"id":"87e5b74a.480508","type":"change","z":"2fdd8124.05e35e","name":"Link URL","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"<a target='_tunnel' href='\" & payload.public_url & \"/ui'>\" & payload.public_url & \"/ui</a>\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":2360,"wires":[["861fe173.d8f1d"]]},{"id":"bb6ebc9f.d7c91","type":"ui_text","z":"2fdd8124.05e35e","group":"23adf1d9.326cae","order":1,"width":0,"height":0,"name":"","label":"Remote Access URL:","format":"{{msg.payload}}","layout":"col-center","x":1540,"y":2400,"wires":[]},{"id":"ca31e3a1.1f1d8","type":"comment","z":"2fdd8124.05e35e","name":"Remote Access Settings","info":"","x":610,"y":2320,"wires":[]},{"id":"d396acc4.86d79","type":"ui_switch","z":"2fdd8124.05e35e","name":"","label":"Enable Remote Access","group":"23adf1d9.326cae","order":3,"width":0,"height":0,"passthru":false,"decouple":"false","topic":"remote_access","style":"","onvalue":"true","onvalueType":"str","onicon":"","oncolor":"","offvalue":"false","offvalueType":"str","officon":"","offcolor":"","x":890,"y":2480,"wires":[["3a3cc1a1.4ee1ee","21546672.c4f77a"]]},{"id":"21546672.c4f77a","type":"exec","z":"2fdd8124.05e35e","command":"/coachproxy/bin/apply_remote_access_settings.sh","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"apply_remote_access_settings.sh","x":1440,"y":2580,"wires":[["fa4267ba.859788"],[],["6d1d1ade.5487f4"]]},{"id":"8534daf0.679d88","type":"ui_text_input","z":"2fdd8124.05e35e","name":"ngrok Authtoken","label":"Enter your ngrok Authtoken","group":"23adf1d9.326cae","order":4,"width":"0","height":"0","passthru":false,"mode":"text","delay":"300","topic":"ngrok_auth","x":910,"y":2520,"wires":[["3ac17815.cc7f48"]]},{"id":"cbbddadf.eeaac8","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Remote Username","label":"Choose a Remote Access username","group":"23adf1d9.326cae","order":5,"width":"0","height":"0","passthru":false,"mode":"text","delay":"300","topic":"remote_username","x":910,"y":2560,"wires":[["3ac17815.cc7f48"]]},{"id":"34c110f5.5bae5","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Remote Password","label":"Choose a Remote Access password","group":"23adf1d9.326cae","order":6,"width":"0","height":"0","passthru":false,"mode":"text","delay":"300","topic":"remote_password","x":910,"y":2600,"wires":[["3ac17815.cc7f48"]]},{"id":"c51c7274.fc736","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"23adf1d9.326cae","order":9,"width":"4","height":"1","passthru":false,"label":"Save","color":"","bgcolor":"","icon":"fa-check","payload":"save","payloadType":"str","topic":"","x":950,"y":2680,"wires":[["17ca583.8f6a7a8","21546672.c4f77a"]]},{"id":"253b33aa.a718ac","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"23adf1d9.326cae","order":10,"width":"2","height":"1","passthru":false,"label":"Undo","color":"","bgcolor":"#8D4040","icon":"fa-undo","payload":"delete","payloadType":"str","topic":"","x":410,"y":2680,"wires":[["99101545.c299f8","14042d19.bd9f63","2e7cb20.e483c4e","b0d20900.53b148"]]},{"id":"cf43085e.f93028","type":"ui_template","z":"2fdd8124.05e35e","group":"23adf1d9.326cae","name":"Remote Access Settings","order":2,"width":"6","height":"3","format":"<div layout=\"column\" layout-align=\"space-between\">\n<p>\nBefore using Remote Access, please read the\n<a target='_blank' href='http://coachproxy.com/remote-access-setup-new'>instructions\non how to set up and configure it.</a>\n</p>\n<p>\nEnter your ngrok Authtoken below, and choose a username and\npassword for your Remote Access service.\n</p>\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":890,"y":2440,"wires":[[]]},{"id":"3a3cc1a1.4ee1ee","type":"link out","z":"2fdd8124.05e35e","name":"Remote access settings changed","links":["e357c5ad.eaba18"],"x":1315,"y":2480,"wires":[]},{"id":"cab70e7f.c6c35","type":"link in","z":"2fdd8124.05e35e","name":"Set remote access fields","links":["b8e34e9a.dc367"],"x":375,"y":2540,"wires":[["faf5ce15.01fda","99101545.c299f8","14042d19.bd9f63","2e7cb20.e483c4e","b0d20900.53b148"]]},{"id":"faf5ce15.01fda","type":"change","z":"2fdd8124.05e35e","name":"settings2.remote_access","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.remote_access')","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":2480,"wires":[["d396acc4.86d79"]]},{"id":"3ac17815.cc7f48","type":"file function","z":"2fdd8124.05e35e","name":"form_field_save.js","filename":".node-red/js/form_field_save.js","reloadfile":false,"outputs":1,"x":1150,"y":2580,"wires":[[]]},{"id":"17ca583.8f6a7a8","type":"function","z":"2fdd8124.05e35e","name":"Save Remote Settings","func":"const topics = ['ngrok_auth', 'remote_username', 'remote_password', 'remote_subdomain'];\nvar msgs = [];\n\ntopics.forEach(function(topic) {\n  const value = global.get('form')[topic] || '';\n  const newmsg = { topic: topic, payload: value };\n  msgs.push(newmsg);\n});\n\nreturn [ msgs ];\n","outputs":1,"noerr":0,"x":1160,"y":2680,"wires":[["3a3cc1a1.4ee1ee"]]},{"id":"99101545.c299f8","type":"change","z":"2fdd8124.05e35e","name":"settings2.ngrok_auth","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.ngrok_auth')","tot":"jsonata"},{"t":"set","p":"form.ngrok_auth","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":2520,"wires":[["8534daf0.679d88"]]},{"id":"14042d19.bd9f63","type":"change","z":"2fdd8124.05e35e","name":"settings2.remote_username","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.remote_username')","tot":"jsonata"},{"t":"set","p":"form.remote_username","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":2560,"wires":[["cbbddadf.eeaac8"]]},{"id":"2e7cb20.e483c4e","type":"change","z":"2fdd8124.05e35e","name":"settings2.remote_password","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"},{"t":"set","p":"form.remote_password","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":2600,"wires":[["34c110f5.5bae5"]]},{"id":"5c225f1a.7e815","type":"catch","z":"2fdd8124.05e35e","name":"Catch ECONNREFUSED","scope":["ea5d3dfc.eb98"],"x":690,"y":2360,"wires":[[]]},{"id":"6cf20fc6.84827","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Remote Subdomain","label":"Custom subdomain (paid plan)","group":"23adf1d9.326cae","order":7,"width":"0","height":"0","passthru":false,"mode":"text","delay":"300","topic":"remote_subdomain","x":900,"y":2640,"wires":[["3ac17815.cc7f48"]]},{"id":"b0d20900.53b148","type":"change","z":"2fdd8124.05e35e","name":"settings2.remote_subdomain","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.remote_subdomain')","tot":"jsonata"},{"t":"set","p":"form.remote_subdomain","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":2640,"wires":[["6cf20fc6.84827"]]},{"id":"54538fd2.68515","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/MESSAGE/REMOTEACCESS","qos":"0","broker":"c1170463.5c7f8","x":390,"y":2720,"wires":[["9e9b422.b80bbc","de6c0a1.abc44f8"]]},{"id":"9e9b422.b80bbc","type":"trigger","z":"2fdd8124.05e35e","op1":"","op2":" ","op1type":"nul","op2type":"str","duration":"15","extend":true,"units":"s","reset":"","bytopic":"all","name":"15 Second Reset","x":650,"y":2700,"wires":[["de6c0a1.abc44f8"]]},{"id":"de6c0a1.abc44f8","type":"ui_text","z":"2fdd8124.05e35e","group":"23adf1d9.326cae","order":8,"width":0,"height":0,"name":"Remote Access Feedback","label":"","format":"{{msg.payload}}","layout":"col-center","x":900,"y":2720,"wires":[]},{"id":"fa4267ba.859788","type":"switch","z":"2fdd8124.05e35e","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"ERR_NGROK_108","vt":"str"},{"t":"cont","v":"ERR_NGROK_313","vt":"str"},{"t":"cont","v":"ERR_NGROK_320","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":1670,"y":2580,"wires":[["71ac1e37.e3b71","41dceeff.d7424"],["97a6afdb.4a884","41dceeff.d7424"],["e9293d09.b25e3","41dceeff.d7424"]]},{"id":"97a6afdb.4a884","type":"change","z":"2fdd8124.05e35e","name":"ERR: Requires paid account","rules":[{"t":"set","p":"payload","pt":"msg","to":"ERROR: Custom subdomains require a paid ngrok account.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1880,"y":2580,"wires":[["c6f9b571.2537f8"]]},{"id":"e9293d09.b25e3","type":"change","z":"2fdd8124.05e35e","name":"ERR: Subdomain not reserved","rules":[{"t":"set","p":"payload","pt":"msg","to":"ERROR: Custom subdomain not available. Reserve at <a target='blank' href=\"https://dashboard.ngrok.com/reserved\">dashboard.ngrok.com/reserved</a>","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1890,"y":2620,"wires":[["c6f9b571.2537f8"]]},{"id":"c6f9b571.2537f8","type":"mqtt out","z":"2fdd8124.05e35e","name":"","topic":"CP/MESSAGE/REMOTEACCESS","qos":"","retain":"","broker":"c1170463.5c7f8","x":2200,"y":2580,"wires":[]},{"id":"71ac1e37.e3b71","type":"change","z":"2fdd8124.05e35e","name":"ERR: Authtoken in use","rules":[{"t":"set","p":"payload","pt":"msg","to":"ERROR: A tunnel is already in use with this Authtoken.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1860,"y":2540,"wires":[["c6f9b571.2537f8"]]},{"id":"5014d075.e57f3","type":"link in","z":"2fdd8124.05e35e","name":"Load settings2 from sqlite","links":["794a5640.1d6578"],"x":535,"y":160,"wires":[["59ca8f91.7aff9"]]},{"id":"794a5640.1d6578","type":"link out","z":"2fdd8124.05e35e","name":"Remote access settings applied","links":["5014d075.e57f3"],"x":1795,"y":2660,"wires":[]},{"id":"6d1d1ade.5487f4","type":"delay","z":"2fdd8124.05e35e","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":2660,"wires":[["794a5640.1d6578"]]},{"id":"41dceeff.d7424","type":"change","z":"2fdd8124.05e35e","name":"Disable RA","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"remote_access","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1830,"y":2480,"wires":[["3a3cc1a1.4ee1ee"]]},{"id":"9e8ccc55.4f957","type":"ui_switch","z":"f6c367c2.63b9b8","name":"Interior Shades","label":"Move Window Shades to \"Interior\" Page","group":"f4d0f875.b5dda8","order":11,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"shades_interior","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":780,"y":1360,"wires":[["4f256116.a0922"]]},{"id":"4eb415af.b6f65c","type":"change","z":"f6c367c2.63b9b8","name":"Set Saved Interior Shades","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.shades_interior = 'true'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":1360,"wires":[["9e8ccc55.4f957"]]},{"id":"b54d8c76.440fd","type":"file in","z":"f6c367c2.63b9b8","name":"features.json","filename":"/coachproxy/configurator/features.json","format":"utf8","chunk":false,"sendError":false,"x":430,"y":200,"wires":[["697d0cce.bc0fa4"]]},{"id":"697d0cce.bc0fa4","type":"json","z":"f6c367c2.63b9b8","name":"","property":"payload","action":"","pretty":false,"x":590,"y":200,"wires":[["4c3c9b2.e18a464"]]},{"id":"4c3c9b2.e18a464","type":"change","z":"f6c367c2.63b9b8","name":"","rules":[{"t":"set","p":"features","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":200,"wires":[["bfb2c3a4.58ad4"]]},{"id":"bfb2c3a4.58ad4","type":"function","z":"f6c367c2.63b9b8","name":"Year Option List","func":"// Populate the \"Year\" menu with appropriate options based\n// on the features.json file.\n\nlet years = global.get('features');\nyears = Object.keys(years).filter(year => year[0] == 2).reverse();\n\nconst yearmsg = { options: years, payload: null, topic: null };\nconst blankmsg = { options: [], payload: null, topic: null }\n\nreturn [yearmsg, blankmsg];","outputs":2,"noerr":0,"x":980,"y":200,"wires":[["6303f680.65dfe8"],["25d3ff72.475b8","21735e3b.c9fa92"]]},{"id":"42d5d825.d7a988","type":"ui_ui_control","z":"f6c367c2.63b9b8","name":"Update when tab is displayed","x":1150,"y":1460,"wires":[["b9c3efcf.5b28"]]},{"id":"e166715c.d96cc","type":"function","z":"f6c367c2.63b9b8","name":"Model Option List","func":"// Populate the \"Floor Plan\" menu with appropriate options based\n// on the user's choice of year and model.\n\nconst years = global.get('features');\n\n// User's choice of year\nconst year = flow.get('year');\n\nif (year && years[year]) {\n  const models = Object.keys(years[year]).filter(model => model != '_comment');\n\n  const modelmsg = { options: models, payload: null, topic: null };\n  const blankmsg = { options: [], payload: null, topic: null }\n\n  return [modelmsg, blankmsg];\n}\n","outputs":2,"noerr":0,"x":1210,"y":360,"wires":[["25d3ff72.475b8"],["21735e3b.c9fa92"]]},{"id":"4c222ef8.3b6f2","type":"function","z":"f6c367c2.63b9b8","name":"Floor Plan Option List","func":"// Populate the \"Floor Plan\" menu with appropriate options based\n// on the user's choice of year and model.\n\nconst years = global.get('features');\n\n// User's choice of year and model\nconst year = flow.get('year');\nconst model = flow.get('model');\n\nif (year && model && years[year][model]) {\n  const floors = Object.keys(years[year][model]).filter(floor => floor != 'Default');\n\n  const floormsg = { options: floors, payload: null, topic: null };\n\n  return [floormsg];\n}\n","outputs":1,"noerr":0,"x":1220,"y":420,"wires":[["21735e3b.c9fa92"]]},{"id":"f900b347.058da","type":"delay","z":"f6c367c2.63b9b8","name":"","pauseType":"delay","timeout":"250","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":360,"wires":[["8466b73c.6d83f8"]]},{"id":"b363f64.81e8f08","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":610,"y":2480,"wires":[["637f5dcf.b94644"]]},{"id":"4ea2babc.bffcf4","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":610,"y":2520,"wires":[["6ed2f25c.9b5cb4"]]},{"id":"369132c8.0a300e","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":610,"y":2560,"wires":[["c98e1ecb.d971d8"]]},{"id":"38322680.caf3aa","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":610,"y":2600,"wires":[["1e3a7369.a0c48d"]]},{"id":"d6cf63b1.0211f","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":610,"y":2640,"wires":[[]]},{"id":"861fe173.d8f1d","type":"rbe","z":"2fdd8124.05e35e","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1350,"y":2400,"wires":[["bb6ebc9f.d7c91"]]},{"id":"998a248b.358218","type":"throttle","z":"2fdd8124.05e35e","name":"","throttleType":"time","timeLimit":"1","timeLimitType":"seconds","countLimit":0,"blockSize":0,"locked":false,"x":680,"y":420,"wires":[["19cb1b48.a85c05"]]},{"id":"cf4a966e.f868f8","type":"ui_dropdown","z":"2fdd8124.05e35e","name":"Item Type","label":"","place":"Select item","group":"7f355d52.ee5a24","order":2,"width":"3","height":"1","passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"notif_type","x":2180,"y":780,"wires":[["f660ee71.1ff5","aa67186c.ca8078"]]},{"id":"5c6e93d8.c5933c","type":"ui_dropdown","z":"2fdd8124.05e35e","name":"Test Type","label":"","place":"Select option","group":"7f355d52.ee5a24","order":3,"width":"3","height":"1","passthru":true,"options":[{"label":"","value":"is above","type":"str"},{"label":"","value":"is below","type":"str"}],"payload":"","topic":"notif_test","x":2180,"y":900,"wires":[["f660ee71.1ff5"]]},{"id":"5e908b9c.0afec4","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Value","label":"Value","group":"7f355d52.ee5a24","order":4,"width":"2","height":"1","passthru":true,"mode":"text","delay":300,"topic":"notif_value","x":2170,"y":820,"wires":[["f660ee71.1ff5"]]},{"id":"f2cf45e0.6fea48","type":"ui_button","z":"2fdd8124.05e35e","name":"Add","group":"7f355d52.ee5a24","order":6,"width":"2","height":"1","passthru":false,"label":"Add","color":"","bgcolor":"","icon":"fa-plus","payload":"","payloadType":"str","topic":"","x":2170,"y":940,"wires":[["9e269e56.8db"]]},{"id":"7961b1ab.02f1d","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":5,"width":"2","height":"1","name":"Unit","label":"","format":"{{msg.payload}}","layout":"row-left","x":2170,"y":860,"wires":[]},{"id":"f660ee71.1ff5","type":"file function","z":"2fdd8124.05e35e","name":"form_field_save.js","filename":".node-red/js/form_field_save.js","reloadfile":false,"outputs":1,"x":2390,"y":820,"wires":[[]]},{"id":"bc50fc72.5c00a","type":"link out","z":"2fdd8124.05e35e","name":"Notification list changed","links":["e357c5ad.eaba18"],"x":2815,"y":940,"wires":[]},{"id":"2d3813c5.7ca87c","type":"ui_ui_control","z":"2fdd8124.05e35e","name":"Tab Selected","x":1650,"y":800,"wires":[["534dbf84.f6e35","cb62cfa5.8c3ef","1f5437da.a92028"]]},{"id":"534dbf84.f6e35","type":"change","z":"2fdd8124.05e35e","name":"Blank","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1970,"y":800,"wires":[["cf4a966e.f868f8","5c6e93d8.c5933c","5e908b9c.0afec4"]]},{"id":"cb62cfa5.8c3ef","type":"function","z":"2fdd8124.05e35e","name":"Notification List","func":"const max_rules = 12;\n\nconst tests = { 'is below': '<', 'is above': '>', 'changes': 'changes' };\nlet notifs = global.get('settings2')['notify_rules'] || [];\n\nnotifs.sort((a,b) => a.notif_type.localeCompare(b.notif_type));\n\nfor (let notif in notifs) {\n    let n = notifs[notif];\n    n.notif_testval = tests[n.notif_test] + ' ' + n.notif_value + n.notif_unit;\n}\n\nreturn [{ payload: notifs }, { enabled: notifs.length < max_rules } ];\n","outputs":2,"noerr":0,"x":1960,"y":1220,"wires":[["2dab49fe.24e916","7bdc4b3a.af9fc4","73e7dc86.68de44","a6c3ff40.3ce2","8de79367.4f83b","80e3152b.1bb128","947e5874.8df9e8","2bc76923.3ecd26","1c1264e0.d3313b","341146e1.0f1a8a","56d0a29.9dd775c","c634ebcd.21fac8","c9ed7542.c74ad8","d6837164.277f7","5d1e530f.7e208c","c17cd721.637cf8","f576e5b3.65c158","10dde211.08883e","4557abd2.2ef3a4","8d2762ea.f3f7f","c99a187.ebca2e8","841132c6.23c0a","b96d0dac.2894f","41ee666a.983e78"],["f2cf45e0.6fea48"]]},{"id":"2dab49fe.24e916","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":11,"width":"3","height":"1","name":"Type1","label":"{{msg.payload[1].notif_type}}","format":"","layout":"row-left","x":2170,"y":1100,"wires":[]},{"id":"7bdc4b3a.af9fc4","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":12,"width":"2","height":"1","name":"Test1","label":"{{msg.payload[1].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1100,"wires":[]},{"id":"4ad5ec39.fab5c4","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete1","group":"7f355d52.ee5a24","order":13,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"1","x":2420,"y":1100,"wires":[["a14cd88f.1a8788"]]},{"id":"73e7dc86.68de44","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":14,"width":"3","height":"1","name":"Type2","label":"{{msg.payload[2].notif_type}}","format":"","layout":"row-left","x":2170,"y":1140,"wires":[]},{"id":"a6c3ff40.3ce2","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":15,"width":"2","height":"1","name":"Test2","label":"{{msg.payload[2].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1140,"wires":[]},{"id":"984ac69b.44d468","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete2","group":"7f355d52.ee5a24","order":16,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"2","x":2420,"y":1140,"wires":[["a14cd88f.1a8788"]]},{"id":"8de79367.4f83b","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":17,"width":"3","height":"1","name":"Type3","label":"{{msg.payload[3].notif_type}}","format":"","layout":"row-left","x":2170,"y":1180,"wires":[]},{"id":"80e3152b.1bb128","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":18,"width":"2","height":"1","name":"Test3","label":"{{msg.payload[3].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1180,"wires":[]},{"id":"2e8c2647.e2c12a","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete3","group":"7f355d52.ee5a24","order":19,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"3","x":2420,"y":1180,"wires":[["a14cd88f.1a8788"]]},{"id":"947e5874.8df9e8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":20,"width":"3","height":"1","name":"Type4","label":"{{msg.payload[4].notif_type}}","format":"","layout":"row-left","x":2170,"y":1220,"wires":[]},{"id":"2bc76923.3ecd26","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":21,"width":"2","height":"1","name":"Test4","label":"{{msg.payload[4].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1220,"wires":[]},{"id":"582295cf.dfd3fc","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete4","group":"7f355d52.ee5a24","order":22,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"4","x":2420,"y":1220,"wires":[["a14cd88f.1a8788"]]},{"id":"1c1264e0.d3313b","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":23,"width":"3","height":"1","name":"Type5","label":"{{msg.payload[5].notif_type}}","format":"","layout":"row-left","x":2170,"y":1260,"wires":[]},{"id":"341146e1.0f1a8a","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":24,"width":"2","height":"1","name":"Test5","label":"{{msg.payload[5].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1260,"wires":[]},{"id":"252de61b.38726a","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete5","group":"7f355d52.ee5a24","order":25,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"5","x":2420,"y":1260,"wires":[["a14cd88f.1a8788"]]},{"id":"56d0a29.9dd775c","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":26,"width":"3","height":"1","name":"Type6","label":"{{msg.payload[6].notif_type}}","format":"","layout":"row-left","x":2170,"y":1300,"wires":[]},{"id":"c634ebcd.21fac8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":27,"width":"2","height":"1","name":"Test6","label":"{{msg.payload[6].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1300,"wires":[]},{"id":"ae9136db.e2dc08","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete6","group":"7f355d52.ee5a24","order":28,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"6","x":2420,"y":1300,"wires":[["a14cd88f.1a8788"]]},{"id":"c9ed7542.c74ad8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":29,"width":"3","height":"1","name":"Type7","label":"{{msg.payload[7].notif_type}}","format":"","layout":"row-left","x":2170,"y":1340,"wires":[]},{"id":"d6837164.277f7","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":30,"width":"2","height":"1","name":"Test7","label":"{{msg.payload[7].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1340,"wires":[]},{"id":"cf0d028.30c63","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete7","group":"7f355d52.ee5a24","order":31,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"7","x":2420,"y":1340,"wires":[["a14cd88f.1a8788"]]},{"id":"5d1e530f.7e208c","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":32,"width":"3","height":"1","name":"Type8","label":"{{msg.payload[8].notif_type}}","format":"","layout":"row-left","x":2170,"y":1380,"wires":[]},{"id":"c17cd721.637cf8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":33,"width":"2","height":"1","name":"Test8","label":"{{msg.payload[8].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1380,"wires":[]},{"id":"eda7b8e3.9d3dd8","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete8","group":"7f355d52.ee5a24","order":34,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"8","x":2420,"y":1380,"wires":[["a14cd88f.1a8788"]]},{"id":"f576e5b3.65c158","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":35,"width":"3","height":"1","name":"Type9","label":"{{msg.payload[9].notif_type}}","format":"","layout":"row-left","x":2170,"y":1420,"wires":[]},{"id":"10dde211.08883e","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":36,"width":"2","height":"1","name":"Test9","label":"{{msg.payload[9].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1420,"wires":[]},{"id":"bd303ab1.796f48","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete9","group":"7f355d52.ee5a24","order":37,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"9","x":2420,"y":1420,"wires":[["a14cd88f.1a8788"]]},{"id":"4557abd2.2ef3a4","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":8,"width":"3","height":"1","name":"Type0","label":"{{msg.payload[0].notif_type}}","format":"","layout":"row-left","x":2170,"y":1060,"wires":[]},{"id":"8d2762ea.f3f7f","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":9,"width":"2","height":"1","name":"Test0","label":"{{msg.payload[0].notif_testval}}","format":"","layout":"row-left","x":2290,"y":1060,"wires":[]},{"id":"6b362347.21e69c","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete0","group":"7f355d52.ee5a24","order":10,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"0","x":2420,"y":1060,"wires":[["a14cd88f.1a8788"]]},{"id":"a14cd88f.1a8788","type":"function","z":"2fdd8124.05e35e","name":"Delete Notification","func":"// Remove a notification rule, update the settings on disk,\n// and refresh the list.\n\nlet notifs = global.get('settings2')['notify_rules'] || [];\nnotifs.splice(msg.topic, 1);  // This changes in global context\n\nreturn { topic: 'notify_rules', payload: JSON.stringify(notifs) };","outputs":1,"noerr":0,"x":2650,"y":1140,"wires":[["bc50fc72.5c00a","cb62cfa5.8c3ef"]]},{"id":"a21456d1.3b7bb8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":7,"width":"0","height":"0","name":"Your notification rules:","label":"","format":"Your notification rules:","layout":"row-center","x":2220,"y":1020,"wires":[]},{"id":"72269b85.831204","type":"link in","z":"2fdd8124.05e35e","name":"Set remote access fields","links":["b8e34e9a.dc367"],"x":1755,"y":160,"wires":[["a41f2c1.cca1ad","9a43afe.4e3335","17af52d.10478ad","b028ecd6.261778","74511b5e.c45cf4","327053dc.38f1ec","6c4a8998.9efa5"]]},{"id":"77c64da5.a00b14","type":"ui_template","z":"2fdd8124.05e35e","group":"d0c7f134.375fd","name":"Notification Intro","order":1,"width":"","height":"","format":"<div layout=\"column\" layout-align=\"space-between\">\n<p><b>Internet Connection Requirement:</b></p>\n<p>Notifications require an active Internet connection\nconfigured in the 'Join your Wi-Fi' section of the 'System' page.</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2200,"y":40,"wires":[[]]},{"id":"a41f2c1.cca1ad","type":"change","z":"2fdd8124.05e35e","name":"settings2.pushover_key","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.pushover_key')","tot":"jsonata"},{"t":"set","p":"form.pushover_key","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1950,"y":160,"wires":[[]]},{"id":"be01f371.8350a","type":"http request","z":"2fdd8124.05e35e","name":"Post to Pushover","method":"POST","ret":"txt","url":"https://api.pushover.net/1/messages.json","x":2710,"y":200,"wires":[[]]},{"id":"e6cb6cf.8a4b99","type":"function","z":"2fdd8124.05e35e","name":"Test Notification Message","func":"let message = \"Hi! This is a test notification from CoachProxyOS to Pushover.\\n\\n\";\nmessage = message + \"You can control your notification sounds, quiet hours, and other \";\nmessage = message + \"options in the Pushover app on your phone or tablet.\";\n\nmsg.headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n};\n\nmsg.payload = { \n    user: global.get('settings2')['pushover_key'],\n    token: 'afvtrcguexvtutk7orsc41m1fcw42i',\n    title: 'CoachProxyOS Test Notification',\n    message: message,\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":2470,"y":200,"wires":[["be01f371.8350a"]]},{"id":"42a33c7d.d713f4","type":"sqlite","z":"2fdd8124.05e35e","mydb":"b2130e68.3a338","name":"CoachProxy","x":890,"y":120,"wires":[["fdb3c34f.12887"]]},{"id":"6cb7aeff.ab5aa","type":"template","z":"2fdd8124.05e35e","name":"Load configs","field":"topic","fieldType":"msg","format":"handlebars","syntax":"plain","template":"select * from configs;","output":"str","x":690,"y":120,"wires":[["42a33c7d.d713f4"]]},{"id":"fdb3c34f.12887","type":"function","z":"2fdd8124.05e35e","name":"Store configs","func":"for (var i = 0; i < (msg.payload).length; i++) {\n    var key = msg.payload[i].key;\n    var value = msg.payload[i].value;\n    global.set('configs.' + key, value);\n}\n\n// Returning NULL would terminate the flow, but other\n// nodes want to know when settings have been loaded.\nreturn {};","outputs":1,"noerr":0,"x":1070,"y":120,"wires":[[]]},{"id":"87e329fa.cd01d8","type":"ui_template","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","name":"Notification Rule Info","order":1,"width":"","height":"","format":"<div>\n<p>Create customized rules below to be notified when values change:</p>\n<p>&nbsp;</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2220,"y":740,"wires":[[]]},{"id":"4d673358.e0d70c","type":"http request","z":"2fdd8124.05e35e","name":"Post to Pushover","method":"POST","ret":"txt","url":"https://api.pushover.net/1/messages.json","tls":"","x":2770,"y":1680,"wires":[[]]},{"id":"93012ad8.0aea38","type":"mqtt out","z":"2fdd8124.05e35e","name":"","topic":"GLOBAL/MESSAGE","qos":"","retain":"","broker":"c1170463.5c7f8","x":2780,"y":1640,"wires":[]},{"id":"4c421b2d.532294","type":"json","z":"477cac19.6a9e64","name":"","property":"payload","action":"","pretty":false,"x":450,"y":460,"wires":[["f3f48ab4.40e4c8"]]},{"id":"c72fb0d.22e175","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/DC_SOURCE_STATUS_SPYDER/#","qos":"2","broker":"c1170463.5c7f8","x":190,"y":480,"wires":[["4c421b2d.532294"]]},{"id":"a59c49cb.b37798","type":"mqtt out","z":"477cac19.6a9e64","name":"CP/BATTERY_VOLTS/BatteryName","topic":"","qos":"","retain":"","broker":"c1170463.5c7f8","x":900,"y":460,"wires":[]},{"id":"f3f48ab4.40e4c8","type":"function","z":"477cac19.6a9e64","name":"decode battery","func":"// Newer coaches send DC_SOURCE_STATUS_SPYDER in addition to the\n// normal DC_SOURCE_STATUS. In these cases, ignore the legacy values.\n\nlet newmsg = {};\n\nconst labels = ['N/A', 'House', 'Chassis', 'House2'];\nnewmsg.topic = 'CP/BATTERY_VOLTS/' + labels[msg.payload.instance];\nnewmsg.payload = msg.payload['dc voltage'];\n\nif ((msg.topic).includes('SPYDER')) {\n    // Remember to only parse _SPYDER messages from now on\n    context.set('use_spyder', true);\n} else {\n    // If _SPYDER messages are used, ignore legacy messages\n    if (context.get('use_spyder')) {\n        newmsg = null;\n    }\n}\n\nmsg.topic = null;  // Overwrite incoming msg topic\nreturn newmsg;\n","outputs":1,"noerr":0,"x":620,"y":460,"wires":[["a59c49cb.b37798"]]},{"id":"94a20186.0131e","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/DC_SOURCE_STATUS/#","qos":"2","broker":"c1170463.5c7f8","x":220,"y":440,"wires":[["4c421b2d.532294"]]},{"id":"75cc5225.c008dc","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/THERMOSTAT_AMBIENT_STATUS/#","qos":"0","broker":"c1170463.5c7f8","x":200,"y":600,"wires":[["aa466896.a650c8"]]},{"id":"aa466896.a650c8","type":"json","z":"477cac19.6a9e64","name":"","x":450,"y":600,"wires":[["e077ae80.1b7e9"]]},{"id":"e077ae80.1b7e9","type":"function","z":"477cac19.6a9e64","name":"decode ambient temp","func":"const first_zone = global.get('settings2').tstat_first_zone || 0;\nconst zone_names = {\n  0: 'Front',\n  1: 'Mid',\n  2: 'Rear',\n  4: 'Wet Bay',\n  5: 'Generator Bay'\n};\n\nconst zone = parseInt(msg.payload.instance) - first_zone;\n\nlet newmsg = {};\nif (zone in zone_names) {\n  newmsg.topic = 'CP/THERMISTOR_TEMP/' + zone_names[zone];\n  newmsg.payload = msg.payload['ambient temp F'];\n\n  return newmsg;\n}\n","outputs":1,"noerr":0,"x":640,"y":600,"wires":[["3e5bd4e9.96126c"]]},{"id":"3e5bd4e9.96126c","type":"mqtt out","z":"477cac19.6a9e64","name":"CP/THERMISTOR_TEMP/ZoneName","topic":"","qos":"","retain":"","broker":"c1170463.5c7f8","x":930,"y":600,"wires":[]},{"id":"80d680be.7453e","type":"comment","z":"477cac19.6a9e64","name":"Republish battery status in simple form","info":"","x":190,"y":400,"wires":[]},{"id":"1f5437da.a92028","type":"file function","z":"2fdd8124.05e35e","name":"notification_menu_options.js","filename":".node-red/js/notification_menu_options.js","reloadfile":false,"outputs":1,"x":1920,"y":760,"wires":[["cf4a966e.f868f8"]]},{"id":"aa67186c.ca8078","type":"file function","z":"2fdd8124.05e35e","name":"notification_submenu_options.js","filename":".node-red/js/notification_submenu_options.js","reloadfile":false,"outputs":3,"x":1910,"y":860,"wires":[["5e908b9c.0afec4"],["7961b1ab.02f1d","f660ee71.1ff5"],["5c6e93d8.c5933c"]]},{"id":"9e269e56.8db","type":"file function","z":"2fdd8124.05e35e","name":"notification_save.js","filename":".node-red/js/notification_save.js","reloadfile":false,"outputs":1,"x":2390,"y":940,"wires":[["bc50fc72.5c00a","cb62cfa5.8c3ef"]]},{"id":"2ad4a4a5.c0435c","type":"link out","z":"2fdd8124.05e35e","name":"Notification list changed","links":["e357c5ad.eaba18"],"x":2635,"y":500,"wires":[]},{"id":"841132c6.23c0a","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":38,"width":"3","height":"1","name":"Type10","label":"{{msg.payload[10].notif_type}}","format":"","layout":"row-left","x":2180,"y":1460,"wires":[]},{"id":"c99a187.ebca2e8","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":39,"width":"2","height":"1","name":"Test10","label":"{{msg.payload[10].notif_testval}}","format":"","layout":"row-left","x":2310,"y":1460,"wires":[]},{"id":"12e77b35.cc70e5","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete10","group":"7f355d52.ee5a24","order":40,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"10","x":2440,"y":1460,"wires":[["a14cd88f.1a8788"]]},{"id":"b96d0dac.2894f","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":41,"width":"3","height":"1","name":"Type11","label":"{{msg.payload[11].notif_type}}","format":"","layout":"row-left","x":2180,"y":1500,"wires":[]},{"id":"41ee666a.983e78","type":"ui_text","z":"2fdd8124.05e35e","group":"7f355d52.ee5a24","order":42,"width":"2","height":"1","name":"Test11","label":"{{msg.payload[11].notif_testval}}","format":"","layout":"row-left","x":2310,"y":1500,"wires":[]},{"id":"961b28dd.9a6368","type":"ui_button","z":"2fdd8124.05e35e","name":"Delete11","group":"7f355d52.ee5a24","order":43,"width":"1","height":"1","passthru":false,"label":"","color":"#8D0000","bgcolor":"#ffffff","icon":"fa-trash fa-lg","payload":"delete","payloadType":"str","topic":"11","x":2440,"y":1500,"wires":[["a14cd88f.1a8788"]]},{"id":"4c155211.73165c","type":"change","z":"477cac19.6a9e64","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload['status definition']","tot":"msg"},{"t":"set","p":"status.power.generator_state","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":320,"wires":[["f0779982.feef28","f36c20e2.5fa84"]]},{"id":"9ed0f068.bea57","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/TANK_STATUS/#","qos":"2","broker":"c1170463.5c7f8","x":1990,"y":1580,"wires":[["a588a38c.08e74"]]},{"id":"bb30fcde.3966a","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/IGNITION","qos":"2","broker":"c1170463.5c7f8","x":2010,"y":1720,"wires":[["aa0e517d.843a4"]]},{"id":"c1cc6bc8.971ed8","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/PARKBRAKE","qos":"2","broker":"c1170463.5c7f8","x":2000,"y":1760,"wires":[["aa0e517d.843a4"]]},{"id":"a193cfb7.3d38","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/GENERATOR","qos":"2","broker":"c1170463.5c7f8","x":2000,"y":1800,"wires":[["aa0e517d.843a4"]]},{"id":"a588a38c.08e74","type":"file function","z":"2fdd8124.05e35e","name":"notification_value_monitor.js","filename":".node-red/js/notification_value_monitor.js","reloadfile":false,"outputs":1,"x":2260,"y":1620,"wires":[["b2a6e1f.56d592"]]},{"id":"b2a6e1f.56d592","type":"file function","z":"2fdd8124.05e35e","name":"notification_deliver.js","filename":".node-red/js/notification_deliver.js","reloadfile":false,"outputs":3,"x":2540,"y":1680,"wires":[["93012ad8.0aea38"],[],["b1b6ffec.c0e758"]]},{"id":"1fb31163.03642f","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/THERMISTOR_TEMP/#","qos":"2","broker":"c1170463.5c7f8","x":1970,"y":1620,"wires":[["a588a38c.08e74"]]},{"id":"aa0e517d.843a4","type":"file function","z":"2fdd8124.05e35e","name":"notification_state_monitor.js","filename":".node-red/js/notification_state_monitor.js","reloadfile":false,"outputs":1,"x":2260,"y":1760,"wires":[["b2a6e1f.56d592"]]},{"id":"40b105ea.d78cfc","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/BATTERY_VOLTS/#","qos":"2","broker":"c1170463.5c7f8","x":1980,"y":1660,"wires":[["a588a38c.08e74"]]},{"id":"447f35ec.e5ed8c","type":"comment","z":"477cac19.6a9e64","name":"Republish thermister status in simple form","info":"","x":200,"y":560,"wires":[]},{"id":"1839ea35.17c7f6","type":"mqtt in","z":"2fdd8124.05e35e","name":"","topic":"CP/AC_SOURCE","qos":"2","broker":"c1170463.5c7f8","x":2000,"y":1840,"wires":[["aa0e517d.843a4"]]},{"id":"6b55576d.e2cef8","type":"mqtt in","z":"477cac19.6a9e64","name":"","topic":"RVC/ATS_AC_STATUS_1/#","qos":"2","broker":"c1170463.5c7f8","x":150,"y":720,"wires":[["d65bb72.5733f48"]]},{"id":"d65bb72.5733f48","type":"json","z":"477cac19.6a9e64","name":"","x":450,"y":720,"wires":[["caa1f759.57aeb8"]]},{"id":"caa1f759.57aeb8","type":"function","z":"477cac19.6a9e64","name":"decode power status","func":"// Output 1: name of current ATS power source\n\nconst genset_status = global.get('status').power.generator_state || 'stopped';\n\n// If the rmsc value is not numeric (e.g. 'n/a'), then\n// the ATS is not receiving any external power.\nif (isNaN(parseFloat(msg.payload['rms current']))) {\n    msg.payload = 'None';\n} else if (genset_status == 'running') {\n    msg.payload = 'Generator';\n} else {\n    msg.payload = 'Shore';\n}\n\nglobal.set('status.power.ac_source', msg.payload);\n\nmsg.type = 'acsource';\nreturn msg;\n","outputs":1,"noerr":0,"x":640,"y":720,"wires":[["12c2cbaa.fb05d4"]]},{"id":"12c2cbaa.fb05d4","type":"mqtt out","z":"477cac19.6a9e64","name":"","topic":"CP/AC_SOURCE","qos":"","retain":"","broker":"c1170463.5c7f8","x":870,"y":720,"wires":[]},{"id":"c1547432.acf568","type":"comment","z":"477cac19.6a9e64","name":"Republish shore power status in simple form","info":"","x":210,"y":680,"wires":[]},{"id":"9a43afe.4e3335","type":"change","z":"2fdd8124.05e35e","name":"settings2.notify_email1","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.notify_email1')","tot":"jsonata"},{"t":"set","p":"form.notify_email1","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":300,"wires":[["373fb080.8bb7d"]]},{"id":"17af52d.10478ad","type":"change","z":"2fdd8124.05e35e","name":"settings2.notify_email2","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.notify_email2')","tot":"jsonata"},{"t":"set","p":"form.notify_email2","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":340,"wires":[["d8776ddc.8befd"]]},{"id":"373fb080.8bb7d","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Email Address 1","label":"Email Address 1","group":"9ed66528.add608","order":2,"width":"","height":"","passthru":true,"mode":"email","delay":"300","topic":"notify_email1","x":2200,"y":300,"wires":[["1da8be4f.944f22"]]},{"id":"d8776ddc.8befd","type":"ui_text_input","z":"2fdd8124.05e35e","name":"Email Address 2","label":"Email Address 2","group":"9ed66528.add608","order":3,"width":"","height":"","passthru":true,"mode":"email","delay":"300","topic":"notify_email2","x":2200,"y":340,"wires":[["1da8be4f.944f22"]]},{"id":"27078391.774bbc","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"9ed66528.add608","order":4,"width":"3","height":"1","label":"Save","color":"","icon":"fa-check","payload":"save","payloadType":"str","topic":"commit","x":2170,"y":380,"wires":[["cfc33f37.56acf"]]},{"id":"967644d2.773408","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"9ed66528.add608","order":5,"width":"3","height":"1","label":"Undo","color":"","icon":"fa-times","payload":"undo","payloadType":"str","topic":"commit","x":1710,"y":320,"wires":[["9a43afe.4e3335","17af52d.10478ad"]]},{"id":"ac861c3c.4281a","type":"ui_template","z":"2fdd8124.05e35e","group":"9ed66528.add608","name":"Email Info","order":1,"width":"6","height":"2","format":"<div layout=\"column\" layout-align=\"space-between\">\n<p><b>E-mail Notification Setup:</b></p>\n<p>Enter up to two addresses to deliver notifications to:</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2180,"y":260,"wires":[[]]},{"id":"1da8be4f.944f22","type":"file function","z":"2fdd8124.05e35e","name":"form_field_save.js","filename":".node-red/js/form_field_save.js","reloadfile":false,"outputs":1,"x":2450,"y":320,"wires":[[]]},{"id":"cfc33f37.56acf","type":"function","z":"2fdd8124.05e35e","name":"Save Email Settings","func":"const topics = ['notify_email1', 'notify_email2'];\nvar msgs = [];\n\ntopics.forEach(function(topic) {\n  const value = global.get('form')[topic] || '';\n  const newmsg = { topic: topic, payload: value };\n  msgs.push(newmsg);\n});\n\nreturn [ msgs ];\n","outputs":1,"noerr":0,"x":2460,"y":380,"wires":[["2ad4a4a5.c0435c"]]},{"id":"73d80bb.31573f4","type":"comment","z":"2fdd8124.05e35e","name":"INSERT PUSHOVER NODES HERE","info":"","x":2240,"y":160,"wires":[]},{"id":"eacf2d96.2dff4","type":"mqtt out","z":"477cac19.6a9e64","name":"","topic":"CP/GENERATOR_STATUS","qos":"","retain":"","broker":"c1170463.5c7f8","x":940,"y":360,"wires":[]},{"id":"f36c20e2.5fa84","type":"change","z":"477cac19.6a9e64","name":"Generator Status with Timestamp","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload & \",\" & ($floor($millis() / 1000))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":360,"wires":[["eacf2d96.2dff4"]]},{"id":"72d2d43b.3aaf94","type":"ui_text","z":"5a05b8f3.894b88","group":"5d7e55cd.f34c2c","order":3,"width":"6","height":"1","name":"Awning Status","label":"","format":"{{msg.payload}}","layout":"row-center","x":3760,"y":2960,"wires":[]},{"id":"23dc5b1a.c8a5dc","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"duration","pt":"msg","to":"$substringAfter(payload, \"duration=\")","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3770,"y":2840,"wires":[["9bf42094.a5b268"]]},{"id":"9bf42094.a5b268","type":"function","z":"5a05b8f3.894b88","name":"Countdown Message","func":"let duration = msg.duration;\n\nif (msg.duration >= 0) {\n    if (msg.duration === 0) {\n        msg.payload = '';\n    } else {\n        msg.payload = \"Awning active for \" + duration + \" sec.\";\n    }\n\n    msg.duration--;\n\n    return msg;\n}","outputs":1,"noerr":0,"x":3760,"y":2880,"wires":[["72d2d43b.3aaf94","27b4e34.028bf9c"]]},{"id":"27b4e34.028bf9c","type":"delay","z":"5a05b8f3.894b88","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3760,"y":2920,"wires":[["9bf42094.a5b268"]]},{"id":"bb67848e.4759b8","type":"ui_template","z":"f6c367c2.63b9b8","group":"e4fd4ed4.a377f","name":"Copyright","order":3,"width":"6","height":"4","format":"<div layout='column' layout-align='space-between'>\n  <p>CoachProxyOS © 2019</p>\n  <p>CoachProxyOS comes with ABSOLUTELY NO WARRANTY.\n  This is free software, and you are welcome to redistribute it\n  under certain conditions.</p>\n  <p>See <a href=\"https://www.gnu.org/licenses/gpl-3.0.html\">https://www.gnu.org/licenses/gpl-3.0.html</a>\n  for complete details.</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":700,"y":80,"wires":[[]]},{"id":"b028ecd6.261778","type":"change","z":"2fdd8124.05e35e","name":"settings2.smtp_host","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.smtp_host')","tot":"jsonata"},{"t":"set","p":"form.smtp_host","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":480,"wires":[["2beb48cd.bc9f1"]]},{"id":"74511b5e.c45cf4","type":"change","z":"2fdd8124.05e35e","name":"settings2.smtp_port","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.smtp_port')","tot":"jsonata"},{"t":"set","p":"form.smtp_port","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":520,"wires":[["4e1f595b.06eef"]]},{"id":"327053dc.38f1ec","type":"change","z":"2fdd8124.05e35e","name":"settings2.smtp_user","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.smtp_user')","tot":"jsonata"},{"t":"set","p":"form.smtp_user","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":560,"wires":[["3a108da8.621912"]]},{"id":"6c4a8998.9efa5","type":"change","z":"2fdd8124.05e35e","name":"settings2.smtp_password","rules":[{"t":"set","p":"payload","pt":"msg","to":"$globalContext('settings2.smtp_password')","tot":"jsonata"},{"t":"set","p":"form.smtp_password","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1950,"y":600,"wires":[["a98ddc00.839c1"]]},{"id":"2beb48cd.bc9f1","type":"ui_text_input","z":"2fdd8124.05e35e","name":"SMTP Server","label":"SMTP Server Name","tooltip":"e.g. smtp.gmail.com","group":"b043acd4.87089","order":2,"width":"","height":"","passthru":true,"mode":"text","delay":"300","topic":"smtp_host","x":2190,"y":480,"wires":[["4275c6af.b94258"]]},{"id":"4e1f595b.06eef","type":"ui_text_input","z":"2fdd8124.05e35e","name":"SMTP Port","label":"SMTP Server Port","tooltip":"e.g. 587","group":"b043acd4.87089","order":3,"width":"","height":"","passthru":true,"mode":"text","delay":"300","topic":"smtp_port","x":2190,"y":520,"wires":[["4275c6af.b94258"]]},{"id":"657e579.184f228","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"b043acd4.87089","order":6,"width":"3","height":"1","label":"Save","color":"","icon":"fa-check","payload":"save","payloadType":"str","topic":"commit","x":2170,"y":640,"wires":[["9767a76d.1419a"]]},{"id":"13ab390c.eaec7f","type":"ui_template","z":"2fdd8124.05e35e","group":"b043acd4.87089","name":"SMTP Info","order":1,"width":"6","height":"2","format":"<div layout=\"column\" layout-align=\"space-between\">\n<p><b>E-mail Server Setup:</b></p>\n<p>Enter your E-mail SMTP Server information:</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2190,"y":440,"wires":[[]]},{"id":"3a108da8.621912","type":"ui_text_input","z":"2fdd8124.05e35e","name":"SMTP Username","label":"SMTP Username","tooltip":"","group":"b043acd4.87089","order":4,"width":"","height":"","passthru":true,"mode":"text","delay":"300","topic":"smtp_user","x":2210,"y":560,"wires":[["4275c6af.b94258"]]},{"id":"a98ddc00.839c1","type":"ui_text_input","z":"2fdd8124.05e35e","name":"SMTP Password","label":"SMTP Password","tooltip":"","group":"b043acd4.87089","order":5,"width":"","height":"","passthru":true,"mode":"text","delay":"300","topic":"smtp_password","x":2210,"y":600,"wires":[["4275c6af.b94258"]]},{"id":"4275c6af.b94258","type":"file function","z":"2fdd8124.05e35e","name":"form_field_save.js","filename":".node-red/js/form_field_save.js","reloadfile":false,"outputs":1,"x":2450,"y":540,"wires":[[]]},{"id":"9767a76d.1419a","type":"function","z":"2fdd8124.05e35e","name":"Save SMTP Settings","func":"const topics = ['smtp_host', 'smtp_port', 'smtp_user', 'smtp_password'];\nvar msgs = [];\n\ntopics.forEach(function(topic) {\n  const value = global.get('form')[topic] || '';\n  const newmsg = { topic: topic, payload: value };\n  msgs.push(newmsg);\n});\n\nreturn [ msgs ];\n","outputs":1,"noerr":0,"x":2460,"y":640,"wires":[["2ad4a4a5.c0435c"]]},{"id":"effffbd9.b9af7","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"b043acd4.87089","order":7,"width":"3","height":"1","label":"Undo","color":"","icon":"fa-times","payload":"undo","payloadType":"str","topic":"commit","x":1670,"y":540,"wires":[["b028ecd6.261778","74511b5e.c45cf4","327053dc.38f1ec","6c4a8998.9efa5"]]},{"id":"b1b6ffec.c0e758","type":"simple-sendmail","z":"2fdd8124.05e35e","name":"simple sendmail","x":2760,"y":1720,"wires":[["188160bb.3534f7"]]},{"id":"188160bb.3534f7","type":"ui_text","z":"2fdd8124.05e35e","group":"d0c7f134.375fd","order":0,"width":"6","height":"1","name":"Mail Notification Status","label":"Succeeded: {{msg.payload.accepted.length}}","format":"","layout":"col-center","x":3010,"y":1720,"wires":[]},{"id":"9ab94ac.b9e2b38","type":"ui_button","z":"2fdd8124.05e35e","name":"","group":"d0c7f134.375fd","order":2,"width":"6","height":"1","passthru":false,"label":"Send Test Message","tooltip":"","color":"","bgcolor":"green","icon":"fa-envelope-o","payload":"test","payloadType":"str","topic":"commit","x":1990,"y":1900,"wires":[["b4cc8482.ebf358"]]},{"id":"b4cc8482.ebf358","type":"change","z":"2fdd8124.05e35e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"This is a test notification from CoachProxyOS","tot":"str"},{"t":"set","p":"subject","pt":"msg","to":"CoachProxyOS Alert!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2300,"y":1900,"wires":[["bceb7ebc.6c1f9","b2a6e1f.56d592"]]},{"id":"bceb7ebc.6c1f9","type":"change","z":"2fdd8124.05e35e","name":"Clear output","rules":[{"t":"set","p":"payload","pt":"msg","to":"{'accepted': []}","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2510,"y":1900,"wires":[["188160bb.3534f7"]]},{"id":"88273480.13a608","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_22/+pred/","label":"Porch","group":"4e2af34d.8f765c","order":20,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"22_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":1480,"wires":[["2b9cec.6cfee314"]]},{"id":"fdf8aa92.b6dac8","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_95/+pred/","label":"Door","group":"4e2af34d.8f765c","order":10,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"95_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":2320,"wires":[["2b9cec.6cfee314"]]},{"id":"377008e9.11fe","type":"ui_switch","z":"5a05b8f3.894b88","name":"/light_96/+pred/","label":"Cargo","group":"4e2af34d.8f765c","order":30,"width":"3","height":"1","passthru":false,"decouple":"true","topic":"96_state","onvalue":"on","onvalueType":"str","onicon":"","oncolor":"","offvalue":"off","offvalueType":"str","officon":"","offcolor":"","x":860,"y":2360,"wires":[["2b9cec.6cfee314"]]},{"id":"5901ce60.cee528","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/22","qos":"0","broker":"c1170463.5c7f8","x":160,"y":1480,"wires":[["3683806a.56ab7"]]},{"id":"2c35ddad.9336f2","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/95","qos":"0","broker":"c1170463.5c7f8","x":160,"y":2320,"wires":[["f7c2a2db.181a2"]]},{"id":"947e684b.ff2c1","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_DIMMER_STATUS_3/96","qos":"0","broker":"c1170463.5c7f8","x":160,"y":2360,"wires":[["e9b9a70d.e61508"]]},{"id":"c6a6dd7b.9bb1e","type":"ui_text","z":"5a05b8f3.894b88","group":"fb4c3e00.5737a","order":3,"width":"3","height":"1","name":"House Battery /battery-house/battery-basic/+pred/","label":"House Battery","format":"{{msg.payload}} Volts","layout":"col-center","x":1130,"y":2760,"wires":[]},{"id":"1612089d.392067","type":"ui_text","z":"5a05b8f3.894b88","group":"fb4c3e00.5737a","order":4,"width":"3","height":"1","name":"Chassis Battery  /battery-chassis/battery-basic/+pred/","label":"Chassis Battery","format":"{{msg.payload}} Volts","layout":"col-center","x":1140,"y":2800,"wires":[]},{"id":"3683806a.56ab7","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":1480,"wires":[["3b91614a.59e3be"]]},{"id":"3b91614a.59e3be","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":1480,"wires":[["88273480.13a608"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"f7c2a2db.181a2","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":2320,"wires":[["70da4893.09d208"]]},{"id":"70da4893.09d208","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":2320,"wires":[["fdf8aa92.b6dac8"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"e9b9a70d.e61508","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":370,"y":2360,"wires":[["aff3959b.60d1a8"]]},{"id":"aff3959b.60d1a8","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":2360,"wires":[["377008e9.11fe"],[]],"outputLabels":["on/off value","brightness value"]},{"id":"c0c7b1bf.52b3b","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":830,"y":2760,"wires":[["c6a6dd7b.9bb1e"]]},{"id":"27651f43.050f8","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"status.power.house_battery_volts","pt":"global","to":"payload['dc voltage']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload['dc voltage']","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":2760,"wires":[["c0c7b1bf.52b3b"]]},{"id":"94cff01e.0194d","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_SOURCE_STATUS_1/1","qos":"2","broker":"c1170463.5c7f8","x":210,"y":2760,"wires":[["1315d6c3.68c019"]]},{"id":"1315d6c3.68c019","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":450,"y":2760,"wires":[["27651f43.050f8"]]},{"id":"52e8712f.1941","type":"rbe","z":"5a05b8f3.894b88","name":"","func":"rbe","gap":"","start":"","inout":"out","x":830,"y":2800,"wires":[["1612089d.392067"]]},{"id":"41e1419b.d342b","type":"mqtt in","z":"5a05b8f3.894b88","name":"","topic":"RVC/DC_SOURCE_STATUS_1/2","qos":"2","broker":"c1170463.5c7f8","x":210,"y":2800,"wires":[["a1cd97fb.4726f8"]]},{"id":"a1cd97fb.4726f8","type":"json","z":"5a05b8f3.894b88","name":"","property":"payload","action":"","pretty":false,"x":450,"y":2800,"wires":[["b36d7f2e.00774"]]},{"id":"b36d7f2e.00774","type":"change","z":"5a05b8f3.894b88","name":"","rules":[{"t":"set","p":"status.power.chassis_battery_volts","pt":"global","to":"payload['dc voltage']","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload['dc voltage']","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":2800,"wires":[["52e8712f.1941"]]},{"id":"2bafa329.60859c","type":"debug","z":"5a05b8f3.894b88","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":550,"y":1080,"wires":[]},{"id":"9ebfbff9.a53c5","type":"debug","z":"5a05b8f3.894b88","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":630,"y":100,"wires":[]},{"id":"1a23892b.952467","type":"file function","z":"5a05b8f3.894b88","name":"","filename":".node-red/js/decoder_rob_dimmer.js","reloadfile":false,"outputs":2,"x":390,"y":60,"wires":[[],[]]},{"id":"dac109f5.ce7508","type":"file function","z":"5a05b8f3.894b88","name":"decode_dc_dimmer_light.js","filename":".node-red/js/decode_dc_dimmer_light.js","reloadfile":false,"outputs":2,"x":580,"y":160,"wires":[["8918319e.52f4"],["e3a07cfd.ff85a"]],"outputLabels":["on/off value","brightness value"]}]